Notebook[{Cell[CellGroupData[{Cell["Tabbing", "CodeSection"], 
     Cell[BoxData[{RowBox[{RowBox[{RowBox[{"TabObject", "::", "usage"}], "=", 
            "\"\""}], ";"}], "\n", RowBox[
         {RowBox[{RowBox[{"CreateTabRow", "::", "usage"}], "=", "\"\""}], 
          ";"}]}], "CodeInput"], 
     Cell[BoxData[{RowBox[{RowBox[{RowBox[{"NotebookCreateTab", "::", 
              "usage"}], "=", "\"\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"NotebookSwitchTab", "::", "usage"}], "=", 
            "\"\""}], ";"}], "\n", RowBox[
         {RowBox[{RowBox[{"NotebookCloseTab", "::", "usage"}], "=", "\"\""}], 
          ";"}]}], "CodeInput"], 
     Cell[BoxData[{RowBox[{RowBox[{RowBox[{"IDETabExists", "::", "usage"}], 
            "=", "\"Not sure where else this one would live...?\""}], ";"}], 
        "\n", RowBox[{RowBox[{"IDETabNames", "::", "usage"}], "=", 
          "\"Not sure where else this one would live...?\""}], "\n", 
        RowBox[{RowBox[{"IDETabNameFiles", "::", "usage"}], "=", 
          "\"Not sure where else this one would live...?\""}]}], 
      "CodeInput"], Cell[BoxData[RowBox[
        {RowBox[{RowBox[{"IDESwitchTab", "::", "usage"}], "=", 
           "\"Switches the IDE tab\""}], ";"}]], "CodeInput"], 
     Cell[BoxData[{RowBox[{RowBox[{RowBox[{"$TabCacheDir", "::", "usage"}], 
            "=", "\"\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"CacheTabData", "::", "usage"}], "=", 
            "\"\""}], ";"}], "\n", RowBox[
         {RowBox[{RowBox[{"LoadCachedTabData", "::", "usage"}], "=", 
            "\"\""}], ";"}], "\n", RowBox[
         {RowBox[{RowBox[{"ClearCachedTabData", "::", "usage"}], "=", 
            "\"\""}], ";"}]}], "CodeInput"], 
     Cell[BoxData[RowBox[{RowBox[{"Begin", "[", "\"`Private`\"", "]"}], 
         ";"}]], "InputSection"], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]TabData\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]$TabCacheDir\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"If", "[", RowBox[
                  {RowBox[{"!", RowBox[{"ValueQ", "[", "$TabCacheDir", 
                       "]"}]}], ",", "\n", "  ", RowBox[{"$TabCacheDir", " ", 
                     "=", " ", RowBox[{"FileNameJoin", "@", RowBox[{"{", 
                         RowBox[{"$TemporaryDirectory", ",", " ", 
                          "\"EasyIDE\"", ",", " ", "\"tab_cache\""}], 
                         "}"}]}]}]}], "\n", "  ", "]"}], ";"}]], 
            "CodeInput"], Cell[BoxData[RowBox[{RowBox[
                {RowBox[{"tabCacheFile", "[", "fileName_", "]"}], ":=", "\n", 
                 "  ", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[
                        {RowBox[{"ef", " ", "=", RowBox[{"ExpandFileName", 
                          "[", "fileName", "]"}]}], ",", "  ", "hashName"}], 
                       "}"}], ",", "\n", "    ", RowBox[{RowBox[{"If", "[", 
                         RowBox[{RowBox[{"!", RowBox[{"DirectoryQ", "[", 
                          "$TabCacheDir", "]"}]}], ",", " ", "\n", "      ", 
                          RowBox[{"CreateDirectory", "[", RowBox[
                          {"$TabCacheDir", ",", " ", RowBox[
                          {"CreateIntermediateDirectories", "\[Rule]", 
                          "True"}]}], "]"}]}], "\n", "      ", "]"}], ";", 
                       "\n", "    ", RowBox[{"hashName", " ", "=", " ", 
                         RowBox[{"FileNameJoin", "@", RowBox[{"{", RowBox[
                          {"$TabCacheDir", ",", " ", RowBox[{RowBox[
                          {"ToString", "[", RowBox[{"Hash", "[", "ef", "]"}], 
                          "]"}], "<>", "\".mx\""}]}], "}"}]}]}]}]}], "\n", 
                   "    ", "]"}]}], ";"}]], "CodeInput"], 
           Cell[BoxData[RowBox[{RowBox[{"checkTabCache", "[", "fileName_", 
                 "]"}], ":=", "\n", "  ", RowBox[{"With", "[", RowBox[
                  {RowBox[{"{", RowBox[{"f", "=", RowBox[{"tabCacheFile", 
                         "[", "fileName", "]"}]}], "}"}], ",", "\n", "    ", 
                   RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"FileExistsQ", 
                          "[", "f", "]"}], "&&", RowBox[{"TrueQ", "[", 
                          RowBox[{RowBox[{"FileDate", "[", "f", "]"}], ">", 
                          RowBox[{"FileDate", "[", "fileName", "]"}]}], 
                          "]"}]}], ",", "\n", "      ", "f", ",", "\n", 
                       "      ", "None"}], "\n", "      ", "]"}]}], "\n", 
                 "    ", "]"}]}]], "CodeInput"], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"loadTabCacheData", "[", 
                    "fileName_String", "]"}], ":=", "\n", "  ", RowBox[
                   {"Replace", "[", RowBox[{RowBox[{"checkTabCache", "[", 
                        "fileName", "]"}], ",", " ", RowBox[{"s_String", 
                        "\[RuleDelayed]", RowBox[{"Quiet", "@", RowBox[
                          {"Import", "[", "s", "]"}]}]}]}], "]"}]}], ";"}], 
              "\n", RowBox[{RowBox[{RowBox[{"loadTabCacheData", "[", "e_", 
                    "]"}], ":=", "\n", "  ", "None"}], ";"}]}], "CodeInput"], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"setTabCacheData", "[", 
                    RowBox[{"fileName_String", ",", " ", "data_"}], "]"}], 
                  ":=", "\n", "  ", RowBox[{"Export", "[", RowBox[
                     {RowBox[{"tabCacheFile", "[", "fileName", "]"}], ",", 
                      " ", "data", ",", " ", "\"MX\""}], "]"}]}], ";"}], 
              "\n", RowBox[{RowBox[{RowBox[{"setTabCacheData", "[", "e__", 
                    "]"}], ":=", "\n", "  ", "$Failed"}], ";"}]}], 
            "CodeInput"], Cell[BoxData[{RowBox[{"LoadCachedTabData", "//", 
                "Clear"}], "\n", RowBox[{RowBox[{RowBox[{"LoadCachedTabData", 
                    "[", RowBox[{"nb_", ",", " ", "tabName_String"}], "]"}], 
                  ":=", "\n", "  ", RowBox[{"loadTabCacheData", "[", 
                    RowBox[{"IDEData", "[", RowBox[{"nb", ",", " ", RowBox[
                         {"{", RowBox[{"\"Tabs\"", ",", " ", "tabName", ",", 
                          " ", "\"File\""}], "}"}]}], "]"}], "]"}]}], ";"}], 
              "\n", RowBox[{RowBox[{RowBox[{"LoadCachedTabData", "[", "nb_", 
                    "]"}], ":=", "\n", "  ", RowBox[{"LoadCachedTabData", 
                    "[", RowBox[{"nb", ",", " ", RowBox[{"IDEData", "[", 
                        RowBox[{"nb", ",", " ", "\"ActiveTab\""}], "]"}]}], 
                    "]"}]}], ";"}]}], "CodeInput"], 
           Cell[BoxData[{RowBox[{"CacheTabData", "//", "Clear"}], "\n", 
              RowBox[{RowBox[{RowBox[{"CacheTabData", "[", RowBox[{"nb_", 
                      ",", " ", "tabName_String", ",", " ", "data_"}], "]"}], 
                  ":=", "\n", "  ", RowBox[{"setTabCacheData", "[", 
                    RowBox[{RowBox[{"IDEData", "[", RowBox[{"nb", ",", " ", 
                          RowBox[{"{", RowBox[{"\"Tabs\"", ",", " ", 
                          "tabName", ",", " ", "\"File\""}], "}"}]}], "]"}], 
                      ",", " ", "data"}], "]"}]}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"CacheTabData", "[", RowBox[{"nb_", 
                      ",", " ", "tabName_String"}], "]"}], ":=", "\n", "  ", 
                  RowBox[{"CacheTabData", "[", RowBox[{"nb", ",", " ", 
                      "tabName", ",", " ", RowBox[{"GetNotebookExpression", 
                        "[", "nb", "]"}]}], "]"}]}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"CacheTabData", "[", "nb_", "]"}], 
                  ":=", "\n", "  ", RowBox[{"CacheTabData", "[", RowBox[
                     {"nb", ",", " ", RowBox[{"IDEData", "[", RowBox[{"nb", 
                          ",", " ", "\"ActiveTab\""}], "]"}]}], "]"}]}], 
                ";"}], "\n", RowBox[{RowBox[{RowBox[{"CacheTabData", "[", 
                    "e___", "]"}], ":=", "\n", "  ", "$Failed"}], ";"}]}], 
            "CodeInput"], Cell[BoxData[{RowBox[{RowBox[{"ClearCachedTabData", 
                  "//", "Clear"}], ";"}], "\n", RowBox[{RowBox[
                 {RowBox[{"ClearCachedTabData", "[", RowBox[{"nb_", ",", " ", 
                      "tabName_"}], "]"}], ":=", "\n", "  ", RowBox[
                   {"Quiet", "[", RowBox[{"DeleteFile", "@", RowBox[
                       {"tabCacheFile", "@", RowBox[{"IDEData", "[", RowBox[
                          {"nb", ",", " ", RowBox[{"{", RowBox[{"\"Tabs\"", 
                          ",", " ", "tabName", ",", " ", "\"File\""}], 
                          "}"}]}], "]"}]}]}], "]"}]}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[{"ClearCachedTabData", "[", "nb_", 
                    "]"}], ":=", "\n", "  ", RowBox[{"ClearCachedTabData", 
                    "[", RowBox[{"nb", ",", " ", RowBox[{"IDEData", "[", 
                        RowBox[{"nb", ",", " ", "\"ActiveTab\""}], "]"}]}], 
                    "]"}]}], ";"}]}], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]ideSetTab\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"ideSetTab", "[", 
                   RowBox[{"nb_", ",", " ", "tabName_"}], "]"}], ":=", "\n", 
                 "\t", RowBox[{RowBox[{"IDEData", "[", RowBox[{"nb", ",", 
                       " ", "\"ActiveTab\""}], "]"}], " ", "=", " ", 
                   "tabName"}]}], ";"}]], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]IDETabNames\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"IDETabNames", "[", "nb_", 
                   "]"}], ":=", "\n", "\t", RowBox[{"Keys", "@", RowBox[
                    {"IDEData", "[", RowBox[{"nb", ",", " ", "\"Tabs\"", ",", 
                       " ", RowBox[{"{", "}"}]}], "]"}]}]}], ";"}]], 
            "CodeInput"]}, Closed]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]IDETabNameFiles\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"IDETabNameFiles", "[", 
                   "nb_", "]"}], ":=", "\n", "\t", RowBox[
                  {RowBox[{RowBox[{"{", RowBox[{RowBox[{"Keys", "[", "#", 
                          "]"}], ",", " ", RowBox[{"Lookup", "[", RowBox[
                          {RowBox[{"Values", "[", "#", "]"}], ",", " ", 
                          "\"File\"", ",", " ", RowBox[{"{", "}"}]}], 
                          "]"}]}], "}"}], "&"}], "@", "\n", "\t\t", 
                   RowBox[{"IDEData", "[", RowBox[{"nb", ",", " ", 
                       "\"Tabs\"", ",", " ", RowBox[{"{", "}"}]}], "]"}]}]}], 
               ";"}]], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]IDETabExists\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"ideTabExists", "[", 
                    RowBox[{"nb_", ",", " ", "tab_"}], "]"}], ":=", "\n", 
                  "\t", RowBox[{"ListQ", "@", RowBox[{"IDEData", "[", 
                      RowBox[{"nb", ",", " ", RowBox[{"{", RowBox[
                          {"\"Tabs\"", ",", " ", "tab"}], "}"}]}], "]"}]}]}], 
                ";"}], "\n", RowBox[{RowBox[{RowBox[{"IDETabExists", "[", 
                    RowBox[{"nb_", ",", " ", "tab_"}], "]"}], ":=", "\n", 
                  "\t", RowBox[{"ListQ", "@", RowBox[{"IDEData", "[", 
                      RowBox[{"nb", ",", " ", RowBox[{"{", RowBox[
                          {"\"Tabs\"", ",", " ", "tab"}], "}"}]}], "]"}]}]}], 
                ";"}]}], "CodeInput"]}, Closed]]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]Tab Objects\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]CreateTabRow\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"CreateTabRow", "[", "refresh_", 
                 "]"}], ":=", "\n", "\t", RowBox[{"With", "[", "\n", "\t\t", 
                 RowBox[{RowBox[{"{", "\n", "\t\t\t", RowBox[{"tns", "=", 
                       "\n", "\t\t\t\t", RowBox[{"Quiet", "@", RowBox[
                          {"Block", "[", "\n", "\t\t\t\t\t", RowBox[
                          {RowBox[{"{", RowBox[{"CurrentValue", "=", "cv"}], 
                          "}"}], ",", " ", "\n", "\t\t\t\t\t", RowBox[
                          {"IDETabNameFiles", "[", RowBox[
                          {"FrontEnd`EvaluationNotebook", "[", "]"}], 
                          "]"}]}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", 
                     "\t\t\t", "}"}], ",", "\n", "\t\t", RowBox[
                    {RowBox[{"Dynamic", "[", "\n", "\t\t\t", RowBox[
                        {RowBox[{"refresh", ";", "\n", "\t\t\t", RowBox[
                          {"Panel", "[", "\n", "\t\t\t ", RowBox[{RowBox[
                          {"Pane", "[", "\n", "  \t\t\t\t", RowBox[{RowBox[
                          {"Grid", "@", RowBox[{"List", "@", RowBox[
                          {"MapThread", "[", RowBox[{"TabObject", ",", " ", 
                          "tns"}], "]"}]}]}], ",", " ", "\n", "  ", 
                          "\t\t\t\t", RowBox[{"BaseStyle", "\[Rule]", 
                          "\"TabbingRow\""}]}], "\n", "  \t\t\t\t", "]"}], 
                          ",", "\n", "  \t\t ", RowBox[{"BaseStyle", 
                          "\[Rule]", "\"TabbingRow\""}]}], "\n", "      ", 
                          "]"}]}], ",", "\n", "\t\t\t", RowBox[
                          {"TrackedSymbols", "\[RuleDelayed]", RowBox[{"{", 
                          "refresh", "}"}]}]}], "\n", "\t\t\t", "]"}], "/.", 
                     RowBox[{"cv", "\[Rule]", "CurrentValue"}]}]}], "\n", 
                 "\t\t", "]"}]}]], "CodeInput"]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]TabObject\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"TabObject", "[", RowBox[
                  {"tabName_String", ",", " ", "file_"}], "]"}], ":=", "\n", 
               RowBox[{"With", "[", "\n", "  ", RowBox[{RowBox[{"{", "\n", 
                     "    ", RowBox[{RowBox[{"c", "=", "\n", 
                         "\t\t\t\t\t\t\t", RowBox[{"Block", "[", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"{", RowBox[
                          {"MathLink`CallFrontEnd", "=", "Identity"}], "}"}], 
                          ",", " ", "\n", "\t\t\t\t\t\t\t\t", RowBox[
                          {"First", "@", RowBox[{"IDEData", "[", RowBox[
                          {RowBox[{"FrontEnd`EvaluationNotebook", "[", "]"}], 
                          ",", " ", "\"ActiveTab\""}], "]"}]}]}], "\n", 
                          "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                       "\t\t\t\t\t\t", RowBox[{"c2", "=", "\n", 
                         "\t\t\t\t\t\t  ", RowBox[{"Block", "[", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"{", RowBox[
                          {"MathLink`CallFrontEnd", "=", "Identity"}], "}"}], 
                          ",", " ", "\n", "\t\t\t\t\t\t\t\t", RowBox[
                          {"First", "@", RowBox[{"IDEData", "[", RowBox[
                          {RowBox[{"FrontEnd`EvaluationNotebook", "[", "]"}], 
                          ",", " ", RowBox[{"{", RowBox[{"\"Tabs\"", ",", 
                          " ", "tabName", ",", " ", "\"Modified\""}], 
                          "}"}]}], "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
                          "]"}]}]}], "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", 
                   "\t  ", RowBox[{"Style", "[", "\n", "  \t\t", RowBox[
                      {RowBox[{"Panel", "[", "\n", "  ", "\t\t\t", RowBox[
                          {RowBox[{"Grid", "[", "\n", "  ", "\t\t\t\t", 
                          RowBox[{"List", "@", RowBox[{"{", "\n", "  ", 
                          "\t\t\t\t\t", RowBox[{RowBox[{"MouseAppearance", 
                          "[", "\n", "  ", "\t\t\t\t\t\t", RowBox[{RowBox[
                          {"RawBoxes", "@", RowBox[{"ButtonBox", "[", "\n", 
                          "  \t\t\t\t\t\t\t", RowBox[{RowBox[{"ToBoxes", "@", 
                          "\n", "              ", RowBox[{"Tooltip", "[", 
                          "\n", "                ", RowBox[{RowBox[{"Pane", 
                          "[", "\n", "                  ", RowBox[{"tabName", 
                          ",", " ", "\n", "                  ", RowBox[
                          {"BaseStyle", "\[Rule]", "\n", 
                          "                    ", RowBox[{"FEPrivate`Which", 
                          "[", "\n", "  \t\t\t\t\t            ", RowBox[
                          {RowBox[{"FEPrivate`SameQ", "[", RowBox[{"c", ",", 
                          " ", "tabName"}], "]"}], ",", "\n", 
                          "  \t\t\t\t\t              ", "\"TabNameActive\"", 
                          ",", "\n", "                      ", RowBox[{
                          "FEPrivate`SameQ", "[", RowBox[{"c2", ",", " ", 
                          "True"}], "]"}], ",", " ", "\n", 
                          "                        ", RowBox[{"{", RowBox[
                          {"\"TabModified\"", ",", " ", "\"TabName\""}], 
                          "}"}], ",", " ", "\n", "                      ", 
                          "True", ",", "\n", "                        ", 
                          "\"TabName\""}], "\n", "                      ", 
                          "]"}]}]}], "\n", "                  ", "]"}], ",", 
                          " ", "\n", "                ", "file"}], "\n", 
                          "                ", "]"}]}], ",", "\n", 
                          "  \t\t\t\t\t\t\t", RowBox[{"BaseStyle", "\[Rule]", 
                          "\"TabName\""}], ",", "\n", "  ", "\t\t\t\t\t\t\t", 
                          RowBox[{"ButtonData", "\[Rule]", "tabName"}]}], 
                          "\n", "  ", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                          "  ", "\t\t\t\t\t\t", "\"LinkHand\""}], "\n", "  ", 
                          "\t\t\t\t\t\t", "]"}], ",", "\n", "  ", 
                          "\t\t\t\t\t", RowBox[{"RawBoxes", "@", RowBox[
                          {"ButtonBox", "[", RowBox[{"\"\"", ",", " ", "\n", 
                          "  ", "\t\t\t\t\t\t", RowBox[{"BaseStyle", 
                          "\[Rule]", "\"TabCloseButton\""}], ",", "\n", "  ", 
                          "\t\t\t\t\t\t", RowBox[{"ButtonData", "\[Rule]", 
                          "tabName"}]}], "\n", "  ", "\t\t\t\t\t\t", 
                          "]"}]}]}], "\n", "  ", "\t\t\t\t\t", "}"}]}], "\n", 
                          "  ", "\t\t\t\t", "]"}], ",", "\n", "  \t\t\t", 
                          RowBox[{"BaseStyle", "\[Rule]", "\n", 
                          "  \t\t\t\t\t", RowBox[{"FEPrivate`Which", "[", 
                          "\n", "  \t\t\t\t\t  ", RowBox[{RowBox[
                          {"FEPrivate`SameQ", "[", RowBox[{"c", ",", " ", 
                          "tabName"}], "]"}], ",", " ", "\n", "  ", "  ", 
                          "\t", "\t", "\t\t\t\t", "\"TabPanelActive\"", ",", 
                          "\n", "  ", "\t\t\t\t\t  ", RowBox[
                          {"FEPrivate`SameQ", "[", RowBox[{"c2", ",", " ", 
                          "True"}], "]"}], ",", "\n", "  \t\t\t\t\t    ", 
                          RowBox[{"{", RowBox[{"\"TabModified\"", ",", " ", 
                          "\"TabPanelBackground\""}], "}"}], ",", "\n", "  ", 
                          "  \t      ", "True", ",", "\n", "  ", 
                          "  \t\t\t\t\t\t", "\"TabPanelBackground\""}], "\n", 
                          "  ", "\t\t\t\t\t\t", "]"}]}], ",", "\n", "  ", 
                          "\t\t\t", RowBox[{"BoxID", "\[Rule]", RowBox[
                          {"tabName", "<>", "\"-tab\""}]}]}], "\n", "  ", 
                         "\t\t\t", "]"}], ",", "\n", "  ", "\t\t", RowBox[
                        {"ContextMenu", "->", RowBox[{"FileEntryContextMenu", 
                          "[", "file", "]"}]}]}], "\n", "  ", "\t\t", 
                     "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput"]}, Open]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]refreshTabs\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"refreshTabs", "[", "nb_", 
                   "]"}], ":=", "\n", "\t", RowBox[{"Replace", "[", "\n", 
                   "\t\t", RowBox[{RowBox[{"IDEData", "[", RowBox[{"nb", ",", 
                         " ", RowBox[{"PrivateKey", "[", 
                          "\"TabsRefreshHandle\"", "]"}]}], "]"}], ",", "\n", 
                     "\t\t", RowBox[{RowBox[{"Hold", "[", "var_", "]"}], 
                       "\[RuleDelayed]", RowBox[{"(", RowBox[{"var", "=", 
                          RowBox[{"RandomReal", "[", "]"}]}], ")"}]}]}], 
                   "\n", "\t\t", "]"}]}], ";"}]], "CodeInput"]}, Closed]]}, 
       Open]], Cell[CellGroupData[{Cell["\[LeftCeiling]Tabbing\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]NotebookCreateTab\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"NotebookCreateTab", "[", 
                 RowBox[{"nb_NotebookObject", ",", " ", "tabName_String", 
                   ",", " ", "tabData_"}], "]"}], ":=", "\n", "\t", RowBox[
                {"(", "\n", "\t\t", RowBox[{RowBox[{RowBox[{"IDEData", "[", 
                       RowBox[{"nb", ",", " ", RowBox[{"{", RowBox[
                          {"\"Tabs\"", ",", " ", "tabName"}], "}"}]}], "]"}], 
                     " ", "=", " ", "tabData"}], ";", "\n", "\t\t", 
                   RowBox[{"refreshTabs", "[", "]"}]}], "\n", "\t\t", 
                 ")"}]}]], "CodeInput"]}, Open]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]NotebookSwitchTab\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{"NotebookSwitchTab", "//", 
                  "Clear"}], ";"}], "\n", RowBox[{RowBox[{RowBox[{"Options", 
                    "[", "NotebookSwitchTab", "]"}], "=", "\n", "  ", 
                  RowBox[{"{", "\n", "    ", RowBox[{RowBox[{"\"UseCache\"", 
                        "\[Rule]", "True"}], ",", "\n", "    ", RowBox[
                       {"\"SaveCurrent\"", "\[Rule]", "False"}]}], "\n", 
                    "    ", "}"}]}], ";"}], "\n", RowBox[{RowBox[
                 {RowBox[{"NotebookSwitchTab", "[", RowBox[
                     {"nb_NotebookObject", ",", " ", "tabName_String", ",", 
                      " ", "\n", "  ", RowBox[{"ops", ":", RowBox[
                         {"OptionsPattern", "[", "]"}]}]}], "\n", "  ", 
                    "]"}], ":=", "\n", "\t", RowBox[{"Module", "[", "\n", 
                    "\t\t", RowBox[{RowBox[{"{", "\n", "\t\t\t", RowBox[
                         {"file", ",", "\n", "\t\t\t", RowBox[{"active", " ", 
                          "=", " ", RowBox[{"IDEData", "[", RowBox[{"nb", 
                          ",", " ", "\"ActiveTab\""}], "]"}]}], ",", "\n", 
                          "\t\t\t", "actFile", ",", "\n", "\t\t\t", "cached", 
                          ",", "\n", "\t\t\t", "modTime", ",", "\n", 
                          "\t\t\t", "buffer"}], "\n", "\t\t\t", "}"}], ",", 
                      "\n", "\t\t", RowBox[{"If", "[", RowBox[{RowBox[
                          {"active", " ", "=!=", " ", "tabName"}], ",", "\n", 
                          "\t\t  ", RowBox[{RowBox[{"If", "[", RowBox[
                          {RowBox[{"active", "=!=", "None"}], ",", "\n", 
                          "\t\t    ", RowBox[{RowBox[{"modTime", " ", "=", 
                          "\n", "  \t\t    ", RowBox[{"FromAbsoluteTime", 
                          "[", RowBox[{RowBox[{"Lookup", "[", RowBox[{RowBox[
                          {"NotebookInformation", "[", "nb", "]"}], ",", " ", 
                          "\"MemoryModificationTime\""}], "]"}], ",", "\n", 
                          "  ", "  \t\t    ", RowBox[{"TimeZone", "\[Rule]", 
                          "0"}]}], "\n", "  ", "  \t\t    ", "]"}]}], ";", 
                          "\n", "    \t\t", RowBox[{"buffer", " ", "=", " ", 
                          RowBox[{"Quantity", "[", RowBox[{"3", ",", " ", 
                          "\"Seconds\""}], "]"}]}], ";", "\n", "\t\t    ", 
                          RowBox[{"actFile", " ", "=", " ", RowBox[
                          {"IDEData", "[", RowBox[{"nb", ",", " ", RowBox[
                          {"{", RowBox[{"\"Tabs\"", ",", " ", "active", ",", 
                          " ", "\"File\""}], "}"}]}], "]"}]}], ";", "\n", 
                          "  \t\t  ", RowBox[{RowBox[{"IDEData", "[", RowBox[
                          {"nb", ",", " ", RowBox[{"{", RowBox[{"\"Tabs\"", 
                          ",", " ", "active", ",", " ", "\"Modified\""}], 
                          "}"}]}], "]"}], " ", "=", " ", "\n", "  \t\t    ", 
                          RowBox[{"Quiet", "[", RowBox[{"!", RowBox[{"TrueQ", 
                          "[", RowBox[{"modTime", " ", "<=", " ", RowBox[
                          {"(", " ", RowBox[{RowBox[{"FileDate", "[", 
                          "actFile", "]"}], " ", "+", " ", "buffer"}], " ", 
                          ")"}]}], "]"}]}], "]"}]}], ";", "\n", "  \t\t\t", 
                          RowBox[{"If", "[", RowBox[{RowBox[{"OptionValue", 
                          "[", "\"UseCache\"", "]"}], ",", "\n", "  ", 
                          "\t\t\t  ", RowBox[{RowBox[{"CacheTabData", "[", 
                          RowBox[{"nb", ",", " ", "active", ",", " ", RowBox[
                          {"GetNotebookExpression", "[", "nb", "]"}]}], 
                          "]"}], ";", "\n", "  ", "\t\t\t  ", RowBox[
                          {"cached", " ", "=", " ", RowBox[{
                          "LoadCachedTabData", "[", RowBox[{"nb", ",", " ", 
                          "tabName"}], "]"}]}], ";"}]}], "\n", "  \t\t\t  ", 
                          "]"}]}]}], "\n", "      ", "]"}], ";", "\n", 
                          "\t\t\t", RowBox[{"If", "[", RowBox[{RowBox[
                          {"OptionValue", "[", "\"SaveCurrent\"", "]"}], ",", 
                          " ", "\n", "\t\t\t  ", RowBox[{"IDESave", "[", 
                          RowBox[{"nb", ",", " ", "\n", "\t\t\t    ", RowBox[
                          {"\"AutoGenerateSave\"", "\[Rule]", "False"}], ",", 
                          "\n", "\t\t\t    ", RowBox[{
                          "\"HandleSavingAction\"", "\[Rule]", "False"}]}], 
                          "\n", "\t\t\t    ", "]"}]}], "\n", "\t\t\t  ", 
                          "]"}], ";", "\n", "\t\t\t", RowBox[{"file", " ", 
                          "=", " ", RowBox[{"IDEData", "[", RowBox[{"nb", 
                          ",", " ", RowBox[{"{", RowBox[{"\"Tabs\"", ",", 
                          " ", "tabName", ",", " ", "\"File\""}], "}"}]}], 
                          "]"}]}], ";", "\n", "\t\t\t", RowBox[
                          {"NotebookPutFile", "[", RowBox[{"nb", ",", " ", 
                          "file", ",", " ", RowBox[{"Replace", "[", RowBox[
                          {"cached", ",", " ", RowBox[{RowBox[{"Except", "[", 
                          "_Notebook", "]"}], "\[Rule]", "None"}]}], "]"}]}], 
                          "]"}], ";", "\n", "\t\t\t", RowBox[{"ideSetTab", 
                          "[", RowBox[{"nb", ",", " ", "tabName"}], "]"}], 
                          ";"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
                    "]"}]}], ";"}], "\n", RowBox[{RowBox[
                 {RowBox[{"NotebookSwitchTab", "[", RowBox[
                     {"nb_NotebookObject", ",", " ", "tabName_String", ",", 
                      " ", RowBox[{"saveCurrent", ":", RowBox[{"True", "|", 
                          "False"}]}]}], "]"}], ":=", "\n", "  ", 
                  RowBox[{"NotebookSwitchTab", "[", RowBox[{"nb", ",", " ", 
                      "tabName", ",", " ", RowBox[{"\"SaveCurrent\"", "->", 
                        "saveCurrent"}]}], "]"}]}], ";"}]}], "CodeInput"]}, 
          Open]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]NotebookCloseTab\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{"NotebookCloseTab", "//", "Clear"}], "\n", 
              RowBox[{RowBox[{RowBox[{"Options", "[", "NotebookCloseTab", 
                    "]"}], "=", "\n", "  ", RowBox[{"{", "\n", "    ", 
                    RowBox[{RowBox[{"\"ClearCache\"", "\[Rule]", "True"}], 
                      ",", "\n", "    ", RowBox[{"\"SaveCurrent\"", 
                        "\[Rule]", "True"}]}], "\n", "    ", "}"}]}], ";"}], 
              "\n", RowBox[{RowBox[{RowBox[{"NotebookCloseTab", "[", 
                    RowBox[{"nb_NotebookObject", ",", " ", "tabName_String", 
                      ",", " ", RowBox[{"ops", ":", RowBox[{"OptionsPattern", 
                          "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
                  RowBox[{"Module", "[", "\n", "\t\t", RowBox[
                     {RowBox[{"{", "\n", "\t\t\t", RowBox[{RowBox[{"active", 
                          " ", "=", " ", RowBox[{"IDEData", "[", RowBox[
                          {"nb", ",", " ", "\"ActiveTab\""}], "]"}]}], ",", 
                          "\n", "\t\t\t", RowBox[{"tabs", " ", "=", " ", 
                          RowBox[{"IDEData", "[", RowBox[{"nb", ",", " ", 
                          "\"Tabs\""}], "]"}]}]}], "\n", "\t\t\t", "}"}], 
                      ",", "\n", "\t\t", RowBox[{"If", "[", RowBox[
                         {RowBox[{"MemberQ", "[", RowBox[{RowBox[{"Keys", 
                          "@", "tabs"}], ",", " ", "tabName"}], "]"}], ",", 
                          "\n", "\t\t\t", RowBox[{RowBox[
                          {"WithNotebookPaused", "[", "\n", "\t\t\t\t", 
                          RowBox[{"nb", ",", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{"tabs", " ", "=", " ", RowBox[
                          {"DeleteCases", "[", RowBox[{"tabs", ",", " ", 
                          RowBox[{"tabName", "\[Rule]", "_"}]}], "]"}]}], 
                          ";", "\n", "\t\t\t\t", RowBox[{"If", "[", RowBox[
                          {RowBox[{"OptionValue", "[", "\"ClearCache\"", 
                          "]"}], ",", "\n", "\t\t\t\t  ", RowBox[
                          {"ClearCachedTabData", "[", RowBox[{"nb", ",", " ", 
                          "tabName"}], "]"}]}], "\n", "\t\t\t\t  ", "]"}], 
                          ";", "\n", "\t\t\t\t", RowBox[{"If", "[", RowBox[
                          {RowBox[{"tabName", " ", "\[Equal]", " ", 
                          "active"}], ",", "\n", "\t\t\t\t  ", RowBox[{RowBox[
                          {"If", "[", RowBox[{RowBox[{"OptionValue", "[", 
                          "\"SaveCurrent\"", "]"}], ",", " ", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"NotebookSaveContents", 
                          "[", RowBox[{"nb", ",", " ", "\n", 
                          "\t\t\t\t\t\t    ", RowBox[{"\"AutoGenerateSave\"", 
                          "\[Rule]", "False"}], ",", "\n", 
                          "\t\t\t\t\t\t    ", RowBox[{
                          "\"HandleSavingAction\"", "\[Rule]", "False"}]}], 
                          "\n", "\t\t\t\t\t\t    ", "]"}]}], "\n", 
                          "\t\t\t\t\t\t  ", "]"}], ";", "\n", "\t\t\t\t\t", 
                          RowBox[{"If", "[", RowBox[{RowBox[{RowBox[
                          {"Length", "@", "tabs"}], " ", ">", " ", "0"}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{
                          "NotebookSwitchTab", "[", RowBox[{"nb", ",", " ", 
                          RowBox[{RowBox[{"Keys", "[", "tabs", "]"}], "[", 
                          RowBox[{"[", "1", "]"}], "]"}], ",", " ", RowBox[
                          {"\"SaveCurrent\"", "\[Rule]", "False"}]}], "]"}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{RowBox[
                          {"NotebookPutContents", "[", RowBox[{"nb", ",", 
                          " ", RowBox[{"Notebook", "[", RowBox[{"{", "}"}], 
                          "]"}]}], "]"}], ";", "\n", "\t\t\t\t\t\t", RowBox[
                          {RowBox[{"IDEData", "[", RowBox[{"nb", ",", " ", 
                          "\"ActiveTab\""}], "]"}], " ", "=", " ", "None"}], 
                          ";"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", 
                          "\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{"IDEData", "[", RowBox[{"nb", ",", " ", 
                          "\"Tabs\""}], "]"}], " ", "=", " ", "tabs"}], 
                          ";"}]}], "\n", "\t\t\t\t", "]"}], ";", "\n", 
                          "\t\t\t", RowBox[{"refreshTabs", "[", "]"}]}]}], 
                        "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
                ";"}], "\n", RowBox[{RowBox[{"NotebookCloseTab", "[", 
                  RowBox[{"nb_NotebookObject", ",", " ", "tabName_String", 
                    ",", " ", RowBox[{"saveCurrent", ":", RowBox[{"True", 
                        "|", "False"}], ":", "True"}]}], "]"}], ":=", "\n", 
                "  ", RowBox[{"NotebookCloseTab", "[", RowBox[{"nb", ",", 
                    " ", "tabName", ",", " ", RowBox[{"\"SaveCurrent\"", 
                      "\[Rule]", "saveCurrent"}]}], "]"}]}]}], "CodeInput"]}, 
          Open]]}, Open]], Cell[CellGroupData[
       {Cell["\[LeftCeiling]IDE\[RightFloor]", "CodeSubsection", 
         Evaluatable -> True], Cell[CellGroupData[
          {Cell["\[LeftCeiling]IDESwitchTab\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"IDESwitchTab", "[", 
                    RowBox[{"nb_NotebookObject", ",", " ", "tagName_"}], 
                    "]"}], ":=", "\n", "\t", RowBox[{"NotebookSwitchTab", 
                    "[", RowBox[{"nb", ",", " ", "tagName"}], "]"}]}], ";"}], 
              "\n", RowBox[{RowBox[{RowBox[{"IDESwitchTab", "[", RowBox[
                     {"ide_IDENotebookObject", ",", " ", "tagName_"}], "]"}], 
                  ":=", "\n", "\t", RowBox[{"IDESwitchTab", "[", RowBox[
                     {RowBox[{"ide", "[", "\"Notebook\"", "]"}], ",", " ", 
                      "tagName"}], "]"}]}], ";"}]}], "CodeInput"]}, 
          Closed]]}, Open]], Cell[BoxData[RowBox[{RowBox[{"End", "[", "]"}], 
         ";"}]], "InputSection"]}, Open]], Cell["", "SectionSeparator"]}, 
 WindowSize -> {808, 755}, WindowMargins -> 
  {{98, Automatic}, {39, Automatic}}, TaggingRules -> 
  {"UUIDButtons" -> 
    {"Active" -> {"Button-89ffd2c3-ec41-4179-a9b1-8e28670bca2c" -> False, 
       "Button-ca46e5e0-4fd1-47e8-8cf6-72998922b757" -> False, 
       "Button-a6d68254-3684-4d32-83fc-e5ef6f443930" -> False}}}, 
 FrontEndVersion -> 
  "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
 StyleDefinitions -> FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
   CharacterEncoding -> "UTF-8"]]
