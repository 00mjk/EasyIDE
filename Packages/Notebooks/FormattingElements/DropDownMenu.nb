(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     30408,        762]
NotebookOptionsPosition[     26836,        687]
NotebookOutlinePosition[     27501,        710]
CellTagsIndexPosition[     27458,        707]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["DropDown Menus", "CodeSection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DestroyDropDownMenu", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Destroys a DropDown menu from its saved state\>\""}], 
  ";"}]], "CodeInput"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AttachDropDownMenu", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Attaches a dropdown menu\>\""}], ";"}]], "CodeInput"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "InputSection"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Attached Cell Menu\[RightFloor]", "CodeSubsection",
 Evaluatable->True],

Cell[CellGroupData[{

Cell["\[LeftCeiling]makeMenuExpr\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeMenuExpr", "[", 
    RowBox[{
     RowBox[{"s", ":", 
      RowBox[{
       RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "state_", "]"}]}], ",",
      " ", "menuList_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Pane", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Panel", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Column", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"makeMenuCommand", "[", 
            RowBox[{"s", ",", " ", "#"}], "]"}], "&"}], "/@", "menuList"}], 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"GridBoxItemSize", "\[Rule]", "Inherited"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"GridBoxAlignment", "\[Rule]", "Inherited"}]}], "\n", 
        "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"BaseStyle", "\[Rule]", "\"\<CascadingMenuMain\>\""}]}], "\n", 
      "\t\t\t", "]"}], ",", "\n", "\t\t", 
     RowBox[{"BaseStyle", "\[Rule]", "\"\<CascadingMenuMain\>\""}], ",", "\n",
      "\t\t", 
     RowBox[{"ImageSizeAction", "\[Rule]", "\"\<Clip\>\""}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]makeMenuCommand\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{"makeMenuCommand", "//", "Clear"}]], "CodeInput",
 CellLabel->"In[946]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeMenuCommand", "[", 
   RowBox[{
    RowBox[{"s", ":", 
     RowBox[{
      RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "state_", "]"}]}], ",", 
    " ", 
    RowBox[{"label_", "->", "list_List"}]}], "]"}], ":=", "\n", "\t\t", 
  RowBox[{"Button", "[", "\n", "\t\t\t", 
   RowBox[{
    RowBox[{"Pane", "[", 
     RowBox[{"label", ",", " ", 
      RowBox[{"BaseStyle", "\[Rule]", "\"\<CascadingMenuSubmenu\>\""}]}], 
     "]"}], ",", "\n", "\t\t\t", 
    RowBox[{"attachMenuExpr", "[", 
     RowBox[{"s", ",", " ", 
      RowBox[{"EvaluationBox", "[", "]"}], ",", " ", 
      RowBox[{"makeMenuExpr", "[", 
       RowBox[{"s", ",", " ", "list"}], "]"}]}], "]"}], ",", "\n", "\t\t\t", 
    RowBox[{"BaseStyle", "\[Rule]", "\"\<CascadingMenuSubmenu\>\""}], ",", 
    "\n", "\t\t\t", 
    RowBox[{"Appearance", "\[Rule]", "Inherited"}]}], "\n", "\t\t\t", 
   "]"}]}]], "CodeInput"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"makeMenuCommand", "[", 
    RowBox[{
     RowBox[{"s", ":", 
      RowBox[{
       RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "state_", "]"}]}], ",",
      " ", 
     RowBox[{"label_", "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{"command_", ",", " ", "ops___"}], "}"}]}]}], "]"}], ":=", "\n",
    "\t", 
   RowBox[{"EventHandler", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Button", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Pane", "[", 
        RowBox[{"label", ",", " ", 
         RowBox[{"BaseStyle", "\[Rule]", "\"\<CascadingMenuCommand\>\""}]}], 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"Internal`WithLocalSettings", "[", "\n", "\t\t\t\t", 
        RowBox[{"Null", ",", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quiet", "[", 
             RowBox[{"Lookup", "[", 
              RowBox[{
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "ops", "}"}]}], ",", " ", "Method", ",", " ", 
               "Automatic"}], "]"}], "]"}], "===", "Automatic"}], ",", "\n", 
           "\t\t\t\t  ", 
           RowBox[{"PreemptiveQueued", "[", 
            RowBox[{
             RowBox[{"EvaluationNotebook", "[", "]"}], ",", " ", "command"}], 
            "]"}], ",", "\n", "\t\t\t\t  ", "command"}], "\n", "\t\t\t\t  ", 
          "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"state", "[", "\"\<DestroyOnClick\>\"", "]"}], ",", " ", 
            RowBox[{"DestroyDropDownMenu", "[", "s", "]"}]}], "]"}], ";"}]}], 
        "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"ButtonData", "\[RuleDelayed]", "s"}], ",", "\n", "\t\t\t", 
       RowBox[{"BaseStyle", "\[Rule]", "\"\<CascadingMenuCommand\>\""}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"Appearance", "\[Rule]", "Inherited"}], ",", "\n", "\t\t\t", 
       "ops"}], "\n", "\t\t\t", "]"}], ",", "\n", "\t ", 
     RowBox[{"{", "\n", "\t \t", 
      RowBox[{
       RowBox[{"\"\<MouseEntered\>\"", "\[RuleDelayed]", " ", 
        RowBox[{"pruneMenu", "[", 
         RowBox[{"s", ",", " ", 
          RowBox[{"EvaluationCell", "[", "]"}], ",", " ", "False"}], "]"}]}], 
       ",", "\n", "\t \t", 
       RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "\n", "\t \t", 
      "}"}]}], "\n", "\t ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"makeMenuCommand", "[", 
   RowBox[{
    RowBox[{"s", ":", 
     RowBox[{
      RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "state_", "]"}]}], ",", 
    " ", 
    RowBox[{"label_", "\[RuleDelayed]", "command_"}]}], "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"makeMenuCommand", "[", 
   RowBox[{"s", ",", " ", 
    RowBox[{"label", "\[RuleDelayed]", 
     RowBox[{"{", "command", "}"}]}]}], "]"}]}]}], "CodeInput"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeMenuCommand", "[", 
   RowBox[{
    RowBox[{"s", ":", 
     RowBox[{
      RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "state_", "]"}]}], ",", 
    " ", "Delimiter"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Framed", "[", 
   RowBox[{"\"\<\>\"", ",", " ", "\n", "\t\t", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"GrayLevel", "[", ".8", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Scaled", "[", "1", "]"}], ",", " ", "0"}], "}"}]}], ",", "\n",
     "\t\t", 
    RowBox[{"FrameMargins", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", " ", "0"}], "}"}]}], "}"}]}]}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellLabel->"In[949]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]pruneMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"pruneMenu", "[", 
   RowBox[{
    RowBox[{"s", ":", 
     RowBox[{
      RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "state_", "]"}]}], ",", 
    " ", "root_", ",", " ", 
    RowBox[{"pruneHead", ":", 
     RowBox[{"True", "|", "False"}], ":", "True"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", "kid", "\n", "\t\t\t", "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{
     RowBox[{"kid", " ", "=", " ", 
      RowBox[{
       RowBox[{"state", "[", "root", "]"}], "[", "\"\<Submenu\>\"", "]"}]}], 
     ";", "\n", "\t\t", 
     RowBox[{"WithNotebookPaused", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"ParentNotebook", "@", "root"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "kid", "]"}], "===", "CellObject"}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"pruneMenu", "[", 
           RowBox[{"s", ",", " ", "kid"}], "]"}]}], "\n", "\t\t\t\t", "]"}], 
        ";", "\n", "\t", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{"pruneHead", ",", " ", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"NotebookDelete", "[", "root", "]"}], ";", "\n", 
           "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"state", ",", " ", "root"}], "]"}], ",", "\n", 
             "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"state", "[", "root", "]"}], "=."}]}], "\n", 
            "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"state", ",", " ", "root"}], "]"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"state", "[", 
               RowBox[{"root", ",", " ", "\"\<Submenu\>\""}], "]"}], "=."}], 
             ";", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"state", "[", 
               RowBox[{"root", ",", " ", "\"\<MenuBox\>\""}], "]"}], "=."}], 
             ";"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", 
         "]"}]}]}], "\n", "\t\t\t", "]"}], ";"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]attachMenuExpr\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"attachMenuExpr", "[", 
    RowBox[{
     RowBox[{"s", ":", 
      RowBox[{
       RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "state_", "]"}]}], ",",
      " ", "parentBox_", ",", " ", "menuExpr_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "parentCell", ",", "\n", "\t\t\t", "cell", ",", "\n", "\t\t\t", 
       "currentKids", ",", "\n", "\t\t\t", "attachPoint", ",", "\n", "\t\t\t",
        "subAttach", ",", "\n", "\t\t\t", "attchPos"}], "\n", "\t\t\t", "}"}],
      ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"parentCell", " ", "=", " ", 
       RowBox[{"ParentCell", "@", "parentBox"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"state", ",", " ", "parentCell"}], "]"}]}], ",", " ", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"state", "[", "parentCell", "]"}], " ", "=", " ", 
         RowBox[{"<|", "|>"}]}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"state", "[", 
       RowBox[{"parentCell", ",", " ", "\"\<MenuBox\>\""}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"parentCell", ",", " ", "\"\<MenuBox\>\""}], "]"}], " ", "=!=",
           " ", "parentBox"}], " ", "||", " ", "\n", "\t\t\t\t", 
         RowBox[{"(", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"state", "[", 
              RowBox[{"parentCell", ",", " ", "\"\<Submenu\>\""}], "]"}], 
             "]"}], " ", "===", " ", "CellObject"}], "&&", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"NotebookRead", "[", 
             RowBox[{"state", "[", 
              RowBox[{"parentCell", ",", " ", "\"\<Submenu\>\""}], "]"}], 
             "]"}], " ", "===", " ", "$Failed"}]}], "\n", "\t\t\t\t\t", 
          ")"}]}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"pruneMenu", "[", 
          RowBox[{"s", ",", " ", "parentCell", ",", " ", "False"}], "]"}], 
         ";", "\n", "\t\t\t", 
         RowBox[{"attachPoint", " ", "=", " ", "\n", "\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"s", "[", "\"\<RootPosition\>\"", "]"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Left", "->", "Right"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"n_", "?", "Positive"}], "\[Rule]", "Right"}], ",", 
              "\n", "\t\t\t\t\t\t", 
              RowBox[{"_", "\[Rule]", "Left"}]}], "\n", "\t\t\t\t\t\t", 
             "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"cell", "=", "\n", "\t\t\t\t", 
          RowBox[{"FEAttachCell", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
           "parentBox", ",", "\n", "\t\t\t\t\t", "menuExpr", ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Offset", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", "0"}], "]"}], 
            ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"attachPoint", ",", " ", "Top"}], "}"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Replace", "[", 
               RowBox[{"attachPoint", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Left", "\[Rule]", "Right"}], ",", " ", 
                  RowBox[{"Right", "\[Rule]", "Left"}]}], "}"}]}], "]"}], ",",
               " ", "Top"}], "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", "\"\<EvaluatorQuit\>\"", "}"}]}], "\n", "\t\t\t\t\t",
            "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"parentCell", ",", " ", "\"\<MenuBox\>\""}], "]"}], " ", 
          "=", " ", "parentBox"}], ";", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"parentCell", ",", " ", "\"\<Submenu\>\""}], "]"}], " ", 
          "=", " ", "cell"}]}]}], "\n", "\t\t\t", "]"}], ";"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]DestroyDropDownMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DestroyDropDownMenu", "[", 
    RowBox[{"s", ":", 
     RowBox[{
      RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "state_", "]"}]}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"(", "\n", "\t\t", 
    RowBox[{
     RowBox[{"pruneMenu", "[", 
      RowBox[{"s", ",", " ", 
       RowBox[{"state", "[", "\"\<RootCell\>\"", "]"}], ",", " ", "True"}], 
      "]"}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"state", "[", "\"\<RootCell\>\"", "]"}], "=."}], ";", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"state", "[", "\"\<Root\>\"", "]"}], "=."}], ";"}], "\n", 
    "\t\t", ")"}]}], ";"}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]AttachDropDownMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[{
 RowBox[{"AttachDropDownMenu", "//", "Clear"}], "\n", 
 RowBox[{
  RowBox[{"Options", "[", "AttachDropDownMenu", "]"}], "=", "\n", "  ", 
  RowBox[{"{", "\n", "    ", 
   RowBox[{
    RowBox[{"\"\<AttachToCell\>\"", "\[Rule]", "True"}], ",", "\n", "    ", 
    RowBox[{"\"\<Position\>\"", "->", "Automatic"}], ",", "\n", "    ", 
    RowBox[{"\"\<DestroyOnClick\>\"", "\[Rule]", "True"}]}], "\n", "    ", 
   "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AttachDropDownMenu", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"stateTracker", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "_", "]"}], 
       RowBox[{"(*", 
        RowBox[{"|", "None"}], "*)"}], ")"}]}], ",", "\n", "\t", 
     RowBox[{"parentBox", ":", 
      RowBox[{"_BoxObject", "|", "Automatic"}], ":", "Automatic"}], ",", " ", 
     "\n", "\t", "menuCommands_List", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"box", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{"parentBox", ",", " ", 
          RowBox[{"Automatic", "\[RuleDelayed]", 
           RowBox[{"EvaluationBox", "[", "]"}]}]}], "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"position", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Position\>\"", "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"attachCell", " ", "=", " ", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<AttachToCell\>\"", "]"}]}]}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"clickDest", " ", "=", " ", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<DestroyOnClick\>\"", "]"}]}]}], ",",
        "\n", "\t\t\t", 
       RowBox[{"state", "=", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"stateTracker", ",", " ", "\n", "\t\t\t\t\t", 
          RowBox[{"None", "\[RuleDelayed]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "menuState", "}"}], ",", " ", 
             RowBox[{"Dynamic", "[", "menuState", "]"}]}], "]"}]}]}], "\n", 
         "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"iMakeMenu", "[", 
      RowBox[{
      "state", ",", " ", "box", ",", " ", "position", ",", " ", "attachCell", 
       ",", " ", "clickDest", ",", " ", "menuCommands"}], "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]}], "CodeInput"],

Cell[BoxData[{
 RowBox[{"iMakeMenu", "//", "Clear"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"iMakeMenu", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"s", ":", 
      RowBox[{
       RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "menuState_", "]"}]}], 
     ",", " ", "\n", "\t", "box_", ",", " ", "\n", "\t", "position_", ",", 
     " ", "\n", "\t", "attachCell_", ",", " ", "\n", "\t", "clickDest_", ",", 
     "\n", "\t", "menuCommands_"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"align", ",", " ", "pos"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"align", " ", "=", " ", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{"Replace", "[", 
         RowBox[{"position", ",", "\n", "\t", "\t\t\t", 
          RowBox[{"{", "\n", "\t", "\t\t\t\t", 
           RowBox[{"Automatic", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{"attachCell", ",", " ", "Right", ",", " ", "Left"}], 
             "]"}]}], "\n", "\t", "\t\t\t\t", "}"}]}], "\n", "\t", "\t\t\t ", 
         "]"}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "will", " ", "need", " ", "an", " ", "update", " ", 
        "once", " ", "I", " ", "am", " ", "able", " ", "to", " ", "get", " ", 
        "the", " ", "box", " ", "position"}], " ", "*)"}], "\n", "\t\t", 
      RowBox[{
       RowBox[{"menuState", "[", "\"\<RootPosition\>\"", "]"}], " ", "=", " ",
        "align"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"menuState", "[", "\"\<AttachToCell\>\"", "]"}], " ", "=", " ",
        "attachCell"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"menuState", "[", "\"\<DestroyOnClick\>\"", "]"}], " ", "=", 
       " ", "clickDest"}], ";", "\n", "\t\t", 
      RowBox[{"Replace", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"FEAttachCell", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"attachCell", ",", " ", 
            RowBox[{"ParentCell", "@", "box"}], ",", " ", "box"}], "]"}], ",",
           "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"AssociationQ", "[", "menuState", "]"}]}], ",", " ", 
             RowBox[{"menuState", "=", 
              RowBox[{"<|", "|>"}]}]}], "]"}], ";", "\n", "\t", "\t\t\t", 
           RowBox[{
            RowBox[{"menuState", "[", "\"\<Root\>\"", "]"}], " ", "=", " ", 
            "box"}], ";", "\n", "\t", "\t\t\t", 
           RowBox[{"Cell", "[", "\n", "\t", "\t\t\t\t", 
            RowBox[{"BoxData", "@", 
             RowBox[{"ToBoxes", "@", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"makeMenuExpr", "[", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"s", ",", " ", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"Append", "[", 
                 RowBox[{"menuCommands", ",", " ", "\n", "\t            ", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<Cancel\>\"", ",", " ", "Italic"}], "]"}], 
                   "\[RuleDelayed]", "\n", "\t              ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"menuState", "[", "\"\<DestroyOnClick\>\"", "]"}],
                     ",", " ", "None", ",", " ", 
                    RowBox[{"DestroyDropDownMenu", "[", "s", "]"}]}], 
                    "]"}]}]}], "\n", "\t            ", "]"}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{"align", ",", " ", "\n", "\t\t\t\t  ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Left", "\[Rule]", "Automatic"}], ",", " ", 
              RowBox[{"Right", "\[Rule]", 
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "22"}], ",", " ", 
                   RowBox[{"-", "1"}]}], "}"}], ",", " ", "0"}], "]"}]}]}], 
             "}"}]}], "\n", "\t\t\t\t  ", "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"align", ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{"attachCell", ",", " ", "Bottom", ",", " ", "Top"}], 
             "]"}]}], "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"attachCell", ",", " ", "align", ",", " ", 
              RowBox[{"Replace", "[", 
               RowBox[{"align", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Left", "\[Rule]", "Right"}], ",", " ", 
                  RowBox[{"Right", "\[Rule]", "Left"}]}], "}"}]}], "]"}]}], 
             "]"}], ",", " ", "Top"}], "}"}], ",", "\n", "\t", "\t\t\t", 
          RowBox[{"{", 
           RowBox[{"(*", 
            RowBox[{"\"\<OutsideMouseClick\>\"", ","}], " ", "*)"}], 
           RowBox[{
           "\"\<ParentChanged\>\"", ",", " ", "\"\<EvaluatorQuit\>\""}], 
           "}"}]}], "\n", "\t", "\t\t\t", "]"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"c_CellObject", "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"menuState", "[", "\"\<RootCell\>\"", "]"}], " ", "=", " ",
            "c"}], ")"}]}]}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], "CodeInput"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "InputSection"]
}, Open  ]],

Cell["", "SectionSeparator"],

Cell[BoxData[
 RowBox[{"CurrentValue", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
    "StyleDefinitions", ",", " ", "\"\<CascadingMenuCommand\>\"", ",", " ", 
     "ButtonBoxOptions"}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[76]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ButtonBoxOptionsBaseStyle", "\[Rule]", "\"\<GenericButton\>\""}],
     ",", 
    RowBox[{"ButtonBoxOptionsDefaultBaseStyle", "\[Rule]", "\"\<Button\>\""}],
     ",", 
    RowBox[{"ButtonBoxOptionsEnabled", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ButtonBoxOptionsAppearance", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Default\>\"", "\[Rule]", "None"}], ",", 
       RowBox[{"\"\<Hover\>\"", "\[Rule]", 
        RowBox[{"FrontEnd`FileName", "[", 
         RowBox[{
          RowBox[{"{", "\"\<EasyIDE\>\"", "}"}], ",", 
          "\"\<MenuItem-Hover.9.png\>\""}], "]"}]}], ",", 
       RowBox[{"\"\<Pressed\>\"", "\[Rule]", 
        RowBox[{"FrontEnd`FileName", "[", 
         RowBox[{
          RowBox[{"{", "\"\<EasyIDE\>\"", "}"}], ",", 
          "\"\<MenuItem-Hover.9.png\>\""}], "]"}]}]}], "}"}]}], ",", 
    RowBox[{"ButtonBoxOptionsBackground", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ButtonBoxOptionsImageSize", "\[Rule]", "Full"}], ",", 
    RowBox[{"ButtonBoxOptionsImageMargins", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ButtonBoxOptionsFrameMargins", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"20", ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15", ",", "15"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ButtonBoxOptionsContentPadding", "\[Rule]", "True"}], ",", 
    RowBox[{"ButtonBoxOptionsBaselinePosition", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ButtonBoxOptionsAlignment", "\[Rule]", "Left"}], ",", 
    RowBox[{"ButtonBoxOptionsAutoAction", "\[Rule]", "False"}], ",", 
    RowBox[{"ButtonBoxOptionsEvaluator", "\[Rule]", "None"}], ",", 
    RowBox[{"ButtonBoxOptionsMethod", "\[Rule]", "\"\<Queued\>\""}], ",", 
    RowBox[{"ButtonBoxOptionsTooltip", "\[Rule]", "None"}], ",", 
    RowBox[{"ButtonBoxOptionsTooltipStyle", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{
    "ButtonBoxOptionsDefaultTooltipStyle", "\[Rule]", 
     "\"\<TooltipLabel\>\""}], ",", 
    RowBox[{"ButtonBoxOptionsTooltipDelay", "\[Rule]", "0.`"}], ",", 
    RowBox[{"ButtonBoxOptionsActive", "\[Rule]", "True"}], ",", 
    RowBox[{"ButtonBoxOptionsButtonFunction", "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"FrontEndExecute", "[", 
        RowBox[{"{", 
         RowBox[{"FrontEnd`NotebookApply", "[", 
          RowBox[{
           RowBox[{"FrontEnd`InputNotebook", "[", "]"}], ",", "#1", ",", 
           "Placeholder"}], "]"}], "}"}], "]"}], "&"}], ")"}]}], ",", 
    RowBox[{"ButtonBoxOptionsButtonSource", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ButtonBoxOptionsButtonData", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ButtonBoxOptionsButtonNote", "\[Rule]", "None"}], ",", 
    RowBox[{"ButtonBoxOptionsButtonFrame", "\[Rule]", "\"\<Automatic\>\""}], 
    ",", 
    RowBox[{"ButtonBoxOptionsButtonMargins", "\[Rule]", "3"}], ",", 
    RowBox[{"ButtonBoxOptionsButtonMinHeight", "\[Rule]", "1.`"}], ",", 
    RowBox[{"ButtonBoxOptionsButtonExpandable", "\[Rule]", "True"}]}], "}"}], 
  " "}]], "Input"]
},
WindowSize->{808, 755},
WindowMargins->{{166, Automatic}, {Automatic, 0}},
TaggingRules->{
 "UUIDButtons" -> {
   "Active" -> {
     "Button-89ffd2c3-ec41-4179-a9b1-8e28670bca2c" -> False, 
      "Button-ca46e5e0-4fd1-47e8-8cf6-72998922b757" -> False, 
      "Button-a6d68254-3684-4d32-83fc-e5ef6f443930" -> False}}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 37, 0, 70, "CodeSection",ExpressionUUID->"06d7ec62-878a-40c3-ac98-cf810a6be1aa"],
Cell[462, 17, 189, 5, 70, "CodeInput",ExpressionUUID->"4f5d39f8-df3f-4baf-8398-dc7a6a1089f2"],
Cell[654, 24, 164, 4, 70, "CodeInput",ExpressionUUID->"2497958d-218a-4815-a202-4331a17a7746"],
Cell[821, 30, 99, 2, 70, "InputSection",ExpressionUUID->"8feaa648-4fd3-4b42-ae43-810def02b0e1"],
Cell[CellGroupData[{
Cell[945, 36, 91, 1, 70, "CodeSubsection",ExpressionUUID->"e96432cc-0eb7-4a14-bd07-50128072445e",
 Evaluatable->True],
Cell[CellGroupData[{
Cell[1061, 41, 88, 1, 70, "CodeSubsubsection",ExpressionUUID->"81a77b46-3e02-45aa-95a9-7b91dba5a85e",
 Evaluatable->True],
Cell[1152, 44, 1163, 29, 70, "CodeInput",ExpressionUUID->"a0695596-b3c6-432d-bd59-a8afbe402937"]
}, Closed]],
Cell[CellGroupData[{
Cell[2352, 78, 91, 1, 70, "CodeSubsubsection",ExpressionUUID->"b2228d79-4cde-4a34-a365-eca0a39bbe1b",
 Evaluatable->True],
Cell[2446, 81, 97, 2, 70, "CodeInput",ExpressionUUID->"3a5e5a1d-345c-4615-8c2a-5857aaf2f28e"],
Cell[2546, 85, 918, 23, 70, "CodeInput",ExpressionUUID->"e6d78c04-fb07-4129-a371-1fd8fcfbdc18"],
Cell[3467, 110, 2868, 70, 70, "CodeInput",ExpressionUUID->"2185ed10-eeff-4b06-b4d0-cc5e5e00defd"],
Cell[6338, 182, 899, 26, 70, "CodeInput",ExpressionUUID->"455fd730-91ad-4e74-ada3-94d5cd4e9108"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7274, 213, 85, 1, 70, "CodeSubsubsection",ExpressionUUID->"6ddec063-149d-4ccb-9fa0-f72bef873185",
 Evaluatable->True],
Cell[7362, 216, 2329, 59, 70, "CodeInput",ExpressionUUID->"a12bc38b-135e-457a-9c2a-711ebaac1fc8"]
}, Closed]],
Cell[CellGroupData[{
Cell[9728, 280, 90, 1, 70, "CodeSubsubsection",ExpressionUUID->"81c2d2dc-3ebc-45cc-9353-f8481e90da7b",
 Evaluatable->True],
Cell[9821, 283, 4431, 102, 70, "CodeInput",ExpressionUUID->"47ea6b8a-2403-45bf-ac20-521ed8c8cf28"]
}, Closed]],
Cell[CellGroupData[{
Cell[14289, 390, 95, 1, 70, "CodeSubsubsection",ExpressionUUID->"a9527ca4-8d68-47ad-887e-ad529a4d84c2",
 Evaluatable->True],
Cell[14387, 393, 663, 19, 70, "CodeInput",ExpressionUUID->"ba75da1e-f07d-4e90-8bee-552f2559a254"]
}, Closed]],
Cell[CellGroupData[{
Cell[15087, 417, 94, 1, 70, "CodeSubsubsection",ExpressionUUID->"1ee6c1e8-fa5d-4861-831a-b6f75b90d293",
 Evaluatable->True],
Cell[15184, 420, 2575, 60, 70, "CodeInput",ExpressionUUID->"7619e005-9674-472e-9ee3-f74db232f9a3"],
Cell[17762, 482, 5473, 118, 70, "CodeInput",ExpressionUUID->"37255447-4ac5-4473-8ca8-364fb3a7d3e7"]
}, Open  ]]
}, Open  ]],
Cell[23262, 604, 76, 2, 70, "InputSection",ExpressionUUID->"b2215e81-1d6e-451e-a71d-75970a991ab1"]
}, Open  ]],
Cell[23353, 609, 28, 0, 70, "SectionSeparator",ExpressionUUID->"b4dd7f02-169d-47e3-9a5d-a30fcaa7fab9"],
Cell[23384, 611, 336, 8, 70, "Input",ExpressionUUID->"5978cfd3-3b40-45c5-8b37-5076d0a8a71a"],
Cell[23723, 621, 3109, 64, 70, "Input",ExpressionUUID->"416fa5a4-3137-4980-876a-a6a65fcc7aa9"]
}
]
*)

