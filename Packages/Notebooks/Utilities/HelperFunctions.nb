Notebook[{Cell[CellGroupData[{Cell["Helper Functions", "CodeSection"], 
     Cell[BoxData[{RowBox[{RowBox[{RowBox[{"WithNotebookPaused", "::", 
              "usage"}], "=", 
            "\"Pauses the notebook temporarily to execute code\""}], ";"}], 
        "\n", RowBox[{RowBox[{RowBox[{"PreemptiveQueued", "::", "usage"}], 
            "=", "\"Evaluates preemptive code in a queued fashion\""}], 
          ";"}]}], "CodeInput"], 
     Cell[BoxData[{RowBox[{RowBox[{RowBox[{"WithCurrentValueUpdating", "::", 
              "usage"}], "=", 
            "\"Executes with CurrentValue updating resumed\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"WithoutCurrentValueUpdating", "::", 
              "usage"}], "=", 
            "\"Executes with CurrentValue updating paused\""}], ";"}]}], 
      "CodeInput"], Cell["\[LeftCeiling]Consistent references to the current \
IDE notebook\[RightFloor]", "Text", Evaluatable -> True], 
     Cell[BoxData[{RowBox[{RowBox[{RowBox[{"$CurrentIDENotebook", "::", 
              "usage"}], "=", "\"\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"$CurrentIDE", "::", "usage"}], "=", 
            "\"\""}], ";"}]}], "CodeInput"], 
     Cell[BoxData[{RowBox[{RowBox[{RowBox[{"iCurrentValue", "::", "usage"}], 
            "=", "\"Just reimplements CurrentValue for when it's needed\""}], 
          ";"}], "\n", RowBox[{RowBox[{RowBox[{"SetCurrentValue", "::", 
              "usage"}], "=", "\"\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"SetCurrentValueDelayed", "::", "usage"}], 
            "=", "\"\""}], ";"}], "\n", 
        RowBox[{RowBox[{RowBox[{"WithIDEData", "::", "usage"}], "=", 
            "\"Reroutes CurrentValue to the EasyIDE path\""}], ";"}]}], 
      "CodeInput"], Cell[BoxData[RowBox[
        {RowBox[{"Begin", "[", "\"`Private`\"", "]"}], ";"}]], 
      "InputSection"], Cell[CellGroupData[
       {Cell["\[LeftCeiling]CurrentValues\[RightFloor]", "CodeSubsection", 
         Evaluatable -> True], Cell[BoxData[RowBox[
           {RowBox[{"iCurrentValue", "[", "a___", "]"}], ":=", "\n", "  ", 
            RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"c", "=", 
                    RowBox[{"FrontEnd`CurrentValue", "[", "a", "]"}]}], 
                  "}"}], ",", "\n", "  ", "  ", RowBox[{"Replace", "[", "\n", 
                  "  ", "    ", RowBox[{RowBox[{"MathLink`CallFrontEnd", "[", 
                      "\n", "  ", "  ", "    ", RowBox[{"FrontEnd`Value", 
                        "[", RowBox[{"c", ",", " ", 
                          "FrontEnd`$TrackingEnabled"}], "]"}], "]"}], ",", 
                    "\n", "  ", "  ", "  ", RowBox[{"c", "\[Rule]", 
                      "$Failed"}]}], "\n", "  ", "    ", "]"}]}], "\n", "  ", 
              "  ", "]"}]}]], "CodeInput"], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]SetCurrentValue\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{"SetCurrentValue", "//", "Clear"}], "\n", 
              RowBox[{RowBox[{"SetCurrentValue", "[", RowBox[{"nb_", ",", 
                    " ", "k_", ",", " ", "value_"}], "]"}], ":=", "\n", "  ", 
                RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"h", "=", 
                        "FrontEnd`$TrackingEnabled"}], "}"}], ",", "\n", 
                    "  \t", RowBox[{"MathLink`CallFrontEndHeld", "[", "\n", 
                      "      ", RowBox[{"FrontEnd`SetValue", "[", "\n", 
                        "\t\t\t\t\t", RowBox[{RowBox[{"FEPrivate`Set", "[", 
                          "\n", "\t\t\t\t\t\t", RowBox[{RowBox[
                          {"FrontEnd`CurrentValue", "[", RowBox[{"nb", ",", 
                          " ", "k"}], "]"}], ",", " ", "\n", "          ", 
                          "value"}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", 
                          "\t\t\t\t\t", "h"}], "\n", "\t\t\t\t\t", "]"}], 
                      "\n", "      ", "]"}]}], "\n", "    ", "]"}]}]}], 
            "CodeInput"]}, Closed]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]SetCurrentValueDelayed\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{"SetCurrentValueDelayed", "//", "Clear"}], 
              "\n", RowBox[{RowBox[{"SetCurrentValueDelayed", "[", 
                  RowBox[{"nb_", ",", " ", "k_", ",", " ", RowBox[{"Hold", 
                      "[", "value_", "]"}]}], "]"}], ":=", "\n", "\t", 
                RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"h", "=", 
                        "FrontEnd`$TrackingEnabled"}], "}"}], ",", "\n", 
                    "  ", "\t", RowBox[{"MathLink`CallFrontEndHeld", "[", 
                      "\n", "  ", "    ", RowBox[{"FrontEnd`SetValue", "[", 
                        "\n", "        ", RowBox[{RowBox[
                          {"FEPrivate`SetDelayed", "[", "\n", "          ", 
                          RowBox[{RowBox[{"FrontEnd`CurrentValue", "[", 
                          RowBox[{"nb", ",", " ", "k"}], "]"}], ",", " ", 
                          "\n", "          ", "value"}], "\n", "  ", 
                          "        ", "]"}], ",", "\n", "  ", "      ", 
                          "h"}], "\n", "  ", "      ", "]"}], "\n", "      ", 
                      "]"}]}], "\n", "    ", "]"}]}]}], "CodeInput"]}, 
          Closed]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]WithIDEData\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"WithIDEData", "[", 
                    RowBox[{"nb_", ",", " ", "expr_"}], "]"}], ":=", "\n", 
                  "  ", RowBox[{"Block", "[", "\n", "    ", RowBox[
                     {RowBox[{"{", "\n", "      ", RowBox[{"CurrentValue", 
                          ",", "\n", "      ", "FrontEnd`Options"}], "\n", 
                        "      ", "}"}], ",", "\n", "    ", RowBox[
                       {RowBox[{RowBox[{"CurrentValue", "[", RowBox[{"a_", 
                          ",", " ", "b_", ",", " ", "c___"}], "]"}], ":=", 
                          "\n", "      ", RowBox[{"Block", "[", RowBox[
                          {RowBox[{"{", RowBox[{"CurrentValue", "=", 
                          "iCurrentValue"}], "}"}], ",", "\n", "        ", 
                          RowBox[{"IDEData", "[", RowBox[{"a", ",", " ", 
                          RowBox[{"Flatten", "@", RowBox[{"{", RowBox[
                          {"\"Options\"", ",", " ", "b"}], "}"}]}], ",", " ", 
                          "c"}], "]"}]}], "\n", "        ", "]"}]}], ";", 
                        "\n", "    ", RowBox[{"CurrentValue", "/:", "\n", 
                          "      ", RowBox[{"(", RowBox[{RowBox[
                          {"CurrentValue", "[", RowBox[{"a_", ",", " ", "b_", 
                          ",", " ", "c___"}], "]"}], " ", "=", " ", "v_"}], 
                          ")"}], ":=", "\n", "        ", RowBox[{"Block", 
                          "[", RowBox[{RowBox[{"{", RowBox[{"CurrentValue", 
                          "=", "iCurrentValue"}], "}"}], ",", "\n", 
                          "          ", RowBox[{RowBox[{"IDEData", "[", 
                          RowBox[{"a", ",", " ", RowBox[{"Flatten", "@", 
                          RowBox[{"{", RowBox[{"\"Options\"", ",", " ", 
                          "b"}], "}"}]}]}], "]"}], " ", "=", " ", "v"}]}], 
                          "\n", "          ", "]"}]}], ";", "\n", "    ", 
                        RowBox[{"CurrentValue", "/:", "\n", "      ", 
                          RowBox[{"(", RowBox[{RowBox[{"CurrentValue", "[", 
                          RowBox[{"a_", ",", " ", "b_", ",", " ", "c___"}], 
                          "]"}], " ", ":=", " ", "v_"}], ")"}], ":=", "\n", 
                          "        ", RowBox[{"Block", "[", RowBox[{RowBox[
                          {"{", RowBox[{"CurrentValue", "=", 
                          "iCurrentValue"}], "}"}], ",", "\n", "          ", 
                          RowBox[{RowBox[{"IDEData", "[", RowBox[{"a", ",", 
                          " ", RowBox[{"Flatten", "@", RowBox[{"{", RowBox[
                          {"\"Options\"", ",", " ", "b"}], "}"}]}]}], "]"}], 
                          " ", ":=", " ", "v"}]}], "\n", "          ", 
                          "]"}]}], ";", "\n", "    ", RowBox[{RowBox[
                          {"FrontEnd`Options", "[", "n_", "]"}], ":=", "\n", 
                          "    \t", RowBox[{"Block", "[", "\n", "    \t\t", 
                          RowBox[{RowBox[{"{", "\n", "    \t\t\t", RowBox[
                          {"CurrentValue", "=", "\n", "    \t\t\t\t", RowBox[
                          {RowBox[{"FrontEnd`Value", "[", RowBox[{RowBox[
                          {"FrontEnd`CurrentValue", "[", "##", "]"}], ",", 
                          " ", "FrontEnd`$TrackingEnabled"}], "]"}], "&"}]}], 
                          "\n", "    \t\t\t", "}"}], ",", "\n", "    \t  ", 
                          RowBox[{"IDEData", "[", RowBox[{"n", ",", " ", 
                          "\"Options\""}], "]"}]}], "\n", "    \t  ", 
                          "]"}]}], ";", "\n", "    ", RowBox[
                         {"Internal`InheritedBlock", "[", RowBox[{RowBox[
                          {"{", "NotebookGet", "}"}], ",", "\n", "    \t", 
                          RowBox[{RowBox[{"Unprotect", "[", "NotebookGet", 
                          "]"}], ";", "\n", "    \t", RowBox[{RowBox[
                          {"NotebookGet", "[", "nb", "]"}], ":=", "\n", 
                          "    \t  ", RowBox[{"Block", "[", "\n", 
                          "    \t  \t", RowBox[{RowBox[{"{", "\n", 
                          "    \t  \t\t", RowBox[{RowBox[{"NotebookGet", "=", 
                          RowBox[{RowBox[{"MathLink`CallFrontEnd", "[", 
                          RowBox[{"FrontEnd`NotebookGet", "[", "nb", "]"}], 
                          "]"}], "&"}]}], ",", "\n", "    \t  \t\t", RowBox[
                          {"CurrentValue", "=", "iCurrentValue"}]}], "\n", 
                          "    \t  \t\t", "}"}], ",", "\n", "    \t\t\t", 
                          RowBox[{"GetNotebookExpression", "[", "nb", 
                          "]"}]}], "\n", "    \t\t\t", "]"}]}], ";", "\n", 
                          " \t   ", "expr"}]}], "\n", " \t   ", "]"}]}]}], 
                    "\n", "    ", "]"}]}], ";"}], "\n", RowBox[{
                RowBox[{"WithIDEData", "~", "SetAttributes", "~", 
                  "HoldRest"}], ";"}]}], "CodeInput"]}, Closed]]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]IDE Refs\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[BoxData[{RowBox[{RowBox[{"$CurrentIDENotebook", " ", ":=", " ", 
               RowBox[{"EvaluationNotebook", "[", "]"}]}], ";"}], "\n", 
           RowBox[{RowBox[{"$CurrentIDE", " ", ":=", " ", RowBox[
                {"IDENotebookObject", "[", "$CurrentIDENotebook", "]"}]}], 
             ";"}]}], "CodeInput"]}, Open]], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]Helpers\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]WithNotebookPaused\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], Cell["\[LeftCeiling]\n\
\tHelper function to suspend the screen while updating the nb\n\[RightFloor]"\
, "Text", Evaluatable -> True], Cell[BoxData[{RowBox[{RowBox[
                 {RowBox[{"WithNotebookPaused", "[", RowBox[
                     {"nb_NotebookObject", ",", " ", "expr_"}], "]"}], ":=", 
                  "\n", "\t", RowBox[{"Block", "[", "\n", "\t", RowBox[
                     {RowBox[{"{", "\n", "\t  ", RowBox[{RowBox[{"paused", 
                          " ", "=", " ", RowBox[{"If", "[", RowBox[{RowBox[
                          {"TrueQ", "@", "paused"}], ",", " ", "True", ",", 
                          " ", "False"}], "]"}]}], ",", "\n", "\t  ", 
                          RowBox[{"FrontEnd`$TrackingEnabled", " ", "=", " ", 
                          "False"}], ",", "\n", "\t  ", "setDataCalls"}], 
                        " ", "\n", "\t    ", RowBox[{"(*", " ", "\n", 
                          "\t            ", RowBox[{RowBox[{RowBox[{RowBox[
                          {RowBox[{"Should", " ", "I", " ", "catch", " ", 
                          "all", " ", "of", " ", "the", " ", "ideSetNbData", 
                          " ", "calls"}], "..."}], "?", " ", "\n", 
                          "\t            ", "I"}], " ", "could", " ", 
                          "batch", " ", "them", " ", "all", " ", "up", " ", 
                          "at", " ", "once", " ", "and", " ", "maybe", " ", 
                          "decrease", " ", "the", " ", "amount", " ", "of", 
                          " ", "processing", " ", "time"}], "..."}], "\n", 
                          "\t            ", "*)"}], "\n", "\t  ", "}"}], ",", 
                      "\n", "\t\t", RowBox[{"If", "[", RowBox[{"paused", ",", 
                          "\n", "\t\t\t", "expr", ",", "\n", "\t\t\t", 
                          RowBox[{"Internal`WithLocalSettings", "[", "\n", 
                          "\t\t\t\t", RowBox[{RowBox[{"FrontEndExecute", "@", 
                          "\n", "\t\t\t\t\t", RowBox[{"{", "\n", 
                          "\t\t\t\t\t  ", RowBox[{RowBox[{
                          "FrontEnd`NotebookSuspendScreenUpdates", "[", "nb", 
                          "]"}], ",", "\n", "\t\t\t\t\t  ", RowBox[
                          {"FrontEnd`SetOptions", "[", RowBox[{"nb", ",", 
                          " ", RowBox[{"DynamicUpdating", "\[Rule]", 
                          "False"}]}], "]"}]}], "\n", "\t\t\t\t\t  ", 
                          "}"}]}], ",", "\n", "\t\t\t\t", RowBox[{RowBox[
                          {"paused", " ", "=", " ", "True"}], ";", "\n", 
                          "\t\t\t\t", "expr"}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"FrontEndExecute", "@", "\n", "\t\t\t\t\t", 
                          RowBox[{"{", "\n", "\t\t\t\t\t  ", RowBox[{RowBox[
                          {"FrontEnd`SetOptions", "[", RowBox[{"nb", ",", 
                          " ", RowBox[{"DynamicUpdating", "\[Rule]", 
                          "Automatic"}]}], "]"}], ",", "\n", "\t\t\t\t\t  ", 
                          RowBox[{"FrontEnd`NotebookResumeScreenUpdates", 
                          "[", "nb", "]"}]}], "\n", "\t\t\t\t\t  ", 
                          "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
                        "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], 
              "\n", RowBox[{"WithNotebookPaused", "~", "SetAttributes", "~", 
                "HoldRest"}]}], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]WithCurrentValueUpdating\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"WithCurrentValueUpdating", 
                    "[", "expr_", "]"}], ":=", "\n", "\t", RowBox[{"Block", 
                    "[", "\n", "\t  ", RowBox[{RowBox[{"{", "\n", "  \t  ", 
                        RowBox[{"FrontEnd`$TrackingEnabled", " ", "=", " ", 
                          "True"}], "\n", "  ", "\t  ", "}"}], ",", "\n", 
                      "\t\t", "expr"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
              RowBox[{"WithCurrentValueUpdating", "~", "SetAttributes", "~", 
                "HoldRest"}]}], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]WithoutCurrentValueUpdating\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], Cell["\[LeftCeiling]\n\
\tHelper function to suspend the screen while updating the nb\n\[RightFloor]"\
, "Text", Evaluatable -> True], Cell[BoxData[
             {RowBox[{"WithoutCurrentValueUpdating", "//", "Clear"}], "\n", 
              RowBox[{RowBox[{RowBox[{"WithoutCurrentValueUpdating", "[", 
                    "expr_", "]"}], ":=", "\n", "\t", RowBox[{"Block", "[", 
                    "\n", "\t  ", RowBox[{RowBox[{"{", "\n", "  \t  ", 
                        RowBox[{"FrontEnd`$TrackingEnabled", " ", "=", " ", 
                          "False"}], "\n", "  ", "\t  ", "}"}], ",", "\n", 
                      "\t\t", "expr"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
              RowBox[{"WithoutCurrentValueUpdating", "~", "SetAttributes", 
                "~", "HoldRest"}]}], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]PreemptiveQueued\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"PreemptiveQueued", "[", 
                    RowBox[{"nb_", ",", " ", "expr_"}], "]"}], ":=", "\n", 
                  "\t", RowBox[{"MessageDialog", "[", "\n", "\t\t", 
                    RowBox[{RowBox[{"DynamicModule", "[", "\n", "\t\t\t", 
                        RowBox[{RowBox[{"{", "}"}], ",", "\n", "\t\t\t", 
                          "Null", ",", "\n", "\t\t\t", RowBox[
                          {"Initialization", "\[RuleDelayed]", RowBox[{"{", 
                          "\n", "\t\t\t\t", RowBox[{
                          "Internal`WithLocalSettings", "[", "\n", 
                          "\t\t\t\t\t", RowBox[{"Null", ",", "\n", 
                          "\t\t\t\t\t", RowBox[{"Block", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"$CurrentIDENotebook", 
                          "=", "nb"}], "\n", "\t\t\t\t\t\t\t", "}"}], ",", 
                          "\n", "\t\t\t\t\t\t", "expr"}], "\n", 
                          "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
                          RowBox[{"NotebookClose", "[", RowBox[
                          {"EvaluationNotebook", "[", "]"}], "]"}]}], "\n", 
                          "\t\t\t\t\t", "]"}], "\n", "\t\t\t\t", "}"}]}], 
                          ",", "\n", "\t\t\t", RowBox[
                          {"SynchronousInitialization", " ", "->", " ", 
                          "False"}]}], "\n", "\t\t\t", "]"}], ",", "\n", 
                      "\t\t", RowBox[{"Visible", "\[Rule]", "False"}], ",", 
                      "\n", "\t\t", RowBox[{"Evaluator", "\[Rule]", RowBox[
                         {"CurrentValue", "[", RowBox[{"nb", ",", " ", 
                          "Evaluator"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
                ";"}], "\n", RowBox[{RowBox[{RowBox[{"PreemptiveQueued", "[", 
                    "expr_", "]"}], ":=", "\n", "  ", RowBox[
                   {"PreemptiveQueued", "[", RowBox[{"$CurrentIDENotebook", 
                      ",", " ", "expr"}], "]"}]}], ";"}], "\n", 
              RowBox[{"PreemptiveQueued", "~", "SetAttributes", "~", 
                "HoldAll"}]}], "CodeInput"]}, Open]]}, Open]], 
     Cell[BoxData[RowBox[{RowBox[{"End", "[", "]"}], ";"}]], 
      "InputSection"]}, Open]], Cell["", "SectionSeparator"]}, 
 WindowSize -> {808, 755}, WindowMargins -> {{112, Automatic}, 
   {45, Automatic}}, TaggingRules -> 
  {"UUIDButtons" -> 
    {"Active" -> {"Button-89ffd2c3-ec41-4179-a9b1-8e28670bca2c" -> False, 
       "Button-ca46e5e0-4fd1-47e8-8cf6-72998922b757" -> False, 
       "Button-a6d68254-3684-4d32-83fc-e5ef6f443930" -> False}}}, 
 FrontEndVersion -> 
  "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
 StyleDefinitions -> FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
   CharacterEncoding -> "UTF-8"]]
