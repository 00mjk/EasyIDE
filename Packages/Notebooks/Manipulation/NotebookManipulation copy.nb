(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     59209,       1495]
NotebookOptionsPosition[     50305,       1321]
NotebookOutlinePosition[     50971,       1344]
CellTagsIndexPosition[     50928,       1341]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Notebook Manipulation", "CodeSection"],

Cell["\<\
\[LeftCeiling]Lower-level functions directly used to manipulate the IDE \
interface\[RightFloor]\
\>", "Text",
 Evaluatable->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NotebookSaveContents", "::", "usage"}], "=", 
   "\"\<Saves the contents of a NotebookObject to a file\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookPutFile", "::", "usage"}], "=", 
   "\"\<Puts a File expression into a NotebookObject\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookPutContents", "::", "usage"}], "=", 
   "\"\<Puts a Notebook into a NotebookObject\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookPutScratch", "::", "usage"}], "=", 
   "\"\<Puts a notebook into a scratch file\>\""}], ";"}]}], "CodeInput"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetNotebookExpression", "::", "usage"}], "=", 
   "\"\<Extracts the Notebook expression\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFileTabName", "::", "usage"}], "=", 
   "\"\<Gets a unique name for a tab\>\""}], ";"}]}], "CodeInput"],

Cell["\[LeftCeiling]The functions provided to an IDENotebookObject as methods\
\[RightFloor]", "Text",
 Evaluatable->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IDEOpen", "::", "usage"}], "=", 
   "\"\<Open a file in the IDE notebook\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IDESave", "::", "usage"}], "=", 
   "\"\<Save the active IDE notebook file\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IDEClose", "::", "usage"}], "=", 
   "\"\<Close the IDE notebook\>\""}], ";"}]}], "CodeInput"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "InputSection"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Notebook Manipulation\[RightFloor]", "CodeSubsection",
 Evaluatable->True],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NotebookPutContents\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell["\<\
\[LeftCeiling]
\tPut a new notebook in the pane
\[RightFloor]\
\>", "Text",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nbPut1", "[", 
    RowBox[{"nbObj_NotebookObject", ",", " ", "nb_Notebook"}], "]"}], ":=", 
   "\n", "\t\t", 
   RowBox[{"Module", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t\t", "baseExpr", "\n", "\t\t\t\t", "}"}], ",", 
     "\n", "\t\t\t", 
     RowBox[{"FrontEndExecute", "@", 
      RowBox[{"{", "\n", "\t\t\t  ", 
       RowBox[{
        RowBox[{"FrontEnd`NotebookPut", "[", "\n", "  \t\t\t\t", 
         RowBox[{
          RowBox[{"Notebook", "[", 
           RowBox[{
            RowBox[{"nb", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"Options", "[", "nbObj", "]"}]}], "]"}], ",", "\n", 
          "  \t\t\t\t", "nbObj"}], "\n", "  \t\t\t\t", "]"}], ",", "\n", 
        "  \t\t\t", 
        RowBox[{"FrontEnd`SelectionMove", "[", "\n", "  \t\t\t\t", 
         RowBox[{
         "nbObj", ",", "\n", "  \t\t\t\t", "Before", ",", "\n", "  \t\t\t\t", 
          "Notebook"}], "\n", "  \t\t\t\t", "]"}]}], "\n", "      ", 
       "}"}]}]}], "\n", "\t\t\t", "]"}]}], ";"}]], "CodeInput"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nbPut2", "[", 
   RowBox[{"enb_NotebookObject", ",", " ", "nb_Notebook"}], "]"}], ":=", "\n",
   "\t", 
  RowBox[{"With", "[", "\n", "\t  ", 
   RowBox[{
    RowBox[{"{", "\n", "     ", 
     RowBox[{
      RowBox[{"mcells", "=", "\n", "       ", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", "\n", "         ", 
         RowBox[{
          RowBox[{"FrontEnd`SelectionMove", "[", 
           RowBox[{"enb", ",", " ", "All", ",", " ", "Notebook"}], "]"}], ",",
           "\n", "         ", 
          RowBox[{"FrontEnd`SetOptions", "[", 
           RowBox[{
            RowBox[{"NotebookSelection", "[", "enb", "]"}], ",", " ", 
            RowBox[{"Deletable", "->", "True"}]}], "]"}], ",", "\n", 
          "         ", 
          RowBox[{"FrontEnd`NotebookDelete", "[", "enb", "]"}]}], "\n", 
         "         ", "}"}]}]}], ",", "\n", "     ", 
      RowBox[{"ops", "=", 
       RowBox[{"Options", "[", "enb", "]"}]}]}], "\n", "    ", "}"}], ",", 
    "\n", "    ", 
    RowBox[{"MathLink`CallFrontEnd", "@", 
     RowBox[{"{", "\n", "     ", 
      RowBox[{"mcells", ",", "\n", "     ", 
       RowBox[{"FrontEnd`SelectionMove", "[", 
        RowBox[{"enb", ",", " ", "Before", ",", " ", "Notebook"}], "]"}], ",",
        "\n", "     ", 
       RowBox[{"FrontEnd`NotebookWrite", "[", 
        RowBox[{"enb", ",", " ", 
         RowBox[{"nb", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "None", ",", "\n", 
         "      ", 
         RowBox[{"AutoScroll", "->", "False"}]}], "\n", "      ", "]"}]}], 
      "\n", "     ", "}"}]}]}], "\n", "   ", "]"}]}]], "CodeInput"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NotebookPutContents", "[", 
   RowBox[{"ideNb_NotebookObject", ",", " ", "nb_Notebook"}], "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ops", "=", 
       RowBox[{"Options", "[", "nb", "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"c", "=", 
       RowBox[{"Cells", "[", "ideNb", "]"}]}]}], "\n", "\t\t\t", "}"}], ",", 
    "\n", "\t\t", 
    RowBox[{
     RowBox[{"WithNotebookPaused", "[", "\n", "\t\t\t", 
      RowBox[{"ideNb", ",", "\n", "     ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "c"}], ">", "100000"}], ",", "\n", 
          "       ", 
          RowBox[{"nbPut1", "[", 
           RowBox[{"ideNb", ",", " ", "nb"}], "]"}], ",", "\n", "       ", 
          RowBox[{"nbPut2", "[", 
           RowBox[{"ideNb", ",", " ", "nb"}], "]"}]}], "\n", "       ", "]"}],
         ";", "\n", "     ", 
        RowBox[{
         RowBox[{"IDEData", "[", 
          RowBox[{"ideNb", ",", " ", "\"\<Options\>\""}], "]"}], " ", "=", 
         " ", "ops"}], ";"}]}], "\n", "     ", "]"}], ";"}]}], "\n", "   ", 
   "]"}]}]], "CodeInput"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]setNbFileStyle\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[CellGroupData[{

Cell["\[LeftCeiling]getFExtStylesheet\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"loadExtStyles", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"Append", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"Normal", "@", "\n", "\t\t\t", 
     RowBox[{"Merge", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"Get", "/@", "\n", "\t", "\t", "\t\t\t", 
        RowBox[{"FileNames", "[", "\n", "\t", "\t", "\t\t\t\t", 
         RowBox[{
         "\"\<ExtensionStylesMap.wl\>\"", ",", "\n", "\t", "\t\t\t\t\t", 
          RowBox[{"FileNames", "[", 
           RowBox[{"\"\<Mappings\>\"", ",", " ", "$IDESettingsPath"}], 
           "]"}]}], "\n", "\t", "\t", "\t\t\t\t", "]"}]}], ",", "\n", "\t", 
       "\t\t\t", "First"}], "\n", "\t", "\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    
    RowBox[{"_", "\[Rule]", "None"}]}], "\n", "\t\t", "]"}]}]], "CodeInput"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getFExtStylesheet", "[", "fExt_", "]"}], ":=", "\n", "\t", 
  RowBox[{"fExt", "/.", 
   RowBox[{"loadExtStyles", "[", "]"}]}]}]], "CodeInput"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]getNbFileSSheet\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadSheetStyles", "[", "]"}], ":=", "\n", "\t", 
   RowBox[{"Append", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Normal", "@", "\n", "\t\t\t", 
      RowBox[{"Merge", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Get", "/@", "\n", "\t", "\t", "\t\t\t", 
         RowBox[{"FileNames", "[", "\n", "\t", "\t", "\t\t\t\t", 
          RowBox[{
          "\"\<StylesheetStylesMap.wl\>\"", ",", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"FileNames", "[", 
            RowBox[{"\"\<Mappings\>\"", ",", " ", "$IDESettingsPath"}], 
            "]"}]}], "\n", "\t", "\t", "\t\t\t\t", "]"}]}], ",", "\n", "\t", 
        "\t\t\t", "First"}], "\n", "\t", "\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"_", "\[Rule]", 
      RowBox[{"FrontEnd`FileName", "[", 
       RowBox[{
        RowBox[{"{", "\"\<EasyIDE\>\"", "}"}], ",", " ", 
        "\"\<LightMode.nb\>\""}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getNbFileSSheet", "[", "nbFile_", "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FileByteCount", "[", "nbFile", "]"}], "<", "1000000"}], ",", 
     "\n", "\t\t", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"g", "=", 
          RowBox[{"Get", "[", "nbFile", "]"}]}], ",", " ", "sd", ",", " ", 
         "sdFile"}], "}"}], ",", "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{"sd", "=", 
         RowBox[{"FirstCase", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", " ", 
              RowBox[{"Rest", "[", "g", "]"}]}], "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"StyleDefinitions", "\[Rule]", "s_"}], ")"}], 
            "\[RuleDelayed]", "s"}], ",", " ", "\"\<Default.nb\>\""}], 
          "]"}]}], ";", "\n", "\t\t\t", 
        RowBox[{"sdFile", "=", "\n", "\t\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"sd", ",", " ", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Except", "[", 
             RowBox[{"_String", "|", "_FrontEnd`FileName"}], "]"}], ":>", 
            "\n", "\t\t\t\t\t\t", 
            RowBox[{"FirstCase", "[", 
             RowBox[{"sd", ",", " ", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"StyleData", "[", 
               RowBox[{
                RowBox[{"StyleDefinitions", "\[Rule]", 
                 RowBox[{"s_", "\[RuleDelayed]", "s"}]}], ",", " ", "___"}], 
               "]"}], ",", " ", "\n", "\t\t\t\t\t\t\t", "\"\<Default.nb\>\"", 
              ",", "\n", "\t\t\t\t\t\t\t", "\[Infinity]"}], "\n", 
             "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], ";", 
        "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringQ", "@", "sdFile"}], "&&", 
           RowBox[{
            RowBox[{"FileNameDepth", "[", "sdFile", "]"}], ">", "1"}]}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"sdFile", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"FrontEnd`FileName", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{";;", 
                  RowBox[{"-", "2"}]}], "]"}], "]"}], ",", " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
            RowBox[{"FileNameSplit", "[", "sdFile", "]"}]}]}]}], "\n", 
         "\t\t\t\t", "]"}], ";", "\n", "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{"Replace", "[", 
          RowBox[{"sdFile", ",", "\n", "\t\t\t\t", 
           RowBox[{"f_FrontEnd`FileName", "\[RuleDelayed]", 
            RowBox[{"ToFileName", "[", "f", "]"}]}]}], "\n", "\t\t\t\t", 
          "]"}], "*)"}], "\n", "\t\t\t", "sdFile"}]}], "\n", "\t\t\t", "]"}], 
     ",", "\n", "\t\t", "$Failed"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"getStylesheetStylesheet", "[", "nbFile_", "]"}], ":=", "\n", "\t", 
  
  RowBox[{
   RowBox[{"getNbFileSSheet", "[", "nbFile", "]"}], "/.", "\n", "\t\t", 
   RowBox[{"loadSheetStyles", "[", "]"}]}]}]}], "CodeInput"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]getFileStylesheet\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"getFileStylesheet", "[", 
   RowBox[{"nb_", ",", " ", "file_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"fExt", " ", "=", " ", 
      RowBox[{"FileExtension", "[", "file", "]"}]}], "\n", "\t\t\t", "}"}], 
    ",", "\n", "\t\t", 
    RowBox[{"getCleanStylePath", "[", "\n", "\t\t\t", 
     RowBox[{"nb", ",", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"getFExtStylesheet", "[", "fExt", "]"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"None", "\[RuleDelayed]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"fExt", "===", "\"\<nb\>\""}], ",", " ", 
           RowBox[{"getStylesheetStylesheet", "[", "file", "]"}], ",", " ", 
           "None"}], "]"}]}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
     "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]setNbFileStyle\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"setNbFileStyle", "[", 
   RowBox[{"nb_", ",", " ", "file_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"currentStyles", " ", "=", " ", 
       RowBox[{"IDEData", "[", 
        RowBox[{"nb", ",", " ", "\"\<StyleSheet\>\"", ",", " ", "None"}], 
        "]"}]}], ",", "\n", "\t\t\t", "mainName", ",", "\n", "\t\t\t", 
      "targ"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"targ", " ", "=", " ", 
      RowBox[{"getFileStylesheet", "[", 
       RowBox[{"nb", ",", " ", "file"}], "]"}]}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"IDEData", "[", 
       RowBox[{"nb", ",", " ", "\"\<StyleSheet\>\""}], "]"}], " ", "=", " ", 
      "targ"}], ";", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"targ", " ", "=!=", " ", "None"}], ",", "\n", "\t\t\t", 
       RowBox[{"SetMainStylesheet", "[", 
        RowBox[{"nb", ",", " ", "targ"}], "]"}]}], "\n", "\t\t\t", "]"}], 
     ";"}]}], "\n", "\t\t", "]"}]}]], "CodeInput"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]setNbFileToolbar\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[CellGroupData[{

Cell["\[LeftCeiling]getFExtToolbar\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"loadExtToolbars", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"Append", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"Normal", "@", "\n", "\t\t\t", 
     RowBox[{"Merge", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"Get", "/@", "\n", "\t", "\t", "\t\t\t", 
        RowBox[{"FileNames", "[", "\n", "\t", "\t\t\t\t\t", 
         RowBox[{
         "\"\<ExtensionToolbarsMap.wl\>\"", ",", "\n", "\t", "\t\t\t\t\t", 
          RowBox[{"FileNames", "[", 
           RowBox[{"\"\<Mappings\>\"", ",", " ", "$IDESettingsPath"}], 
           "]"}]}], "\n", "\t", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
       "\t\t\t", "First"}], "\n", "\t", "\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    
    RowBox[{"_", "\[Rule]", "None"}]}], "\n", "\t\t", "]"}]}]], "CodeInput"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getFExtToolbar", "[", "fExt_", "]"}], ":=", "\n", "\t", 
  RowBox[{"fExt", "/.", 
   RowBox[{"loadExtToolbars", "[", "]"}]}]}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]getStylesheetToolbar\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadSheetToolbars", "[", "]"}], ":=", "\n", "\t", 
   RowBox[{"Append", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Normal", "@", "\n", "\t\t\t", 
      RowBox[{"Merge", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Get", "/@", "\n", "\t", "\t", "\t\t\t", 
         RowBox[{"FileNames", "[", "\n", "\t", "\t\t\t\t\t", 
          RowBox[{
          "\"\<StylesheetToolbarsMap.wl\>\"", ",", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"FileNames", "[", 
            RowBox[{"\"\<Mappings\>\"", ",", " ", "$IDESettingsPath"}], 
            "]"}]}], "\n", "\t", "\t", "\t\t\t\t", "]"}]}], ",", "\n", "\t", 
        "\t\t\t", "First"}], "\n", "\t", "\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"_", "\[Rule]", "None"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getStylesheetToolbar", "[", "nbFile_", "]"}], ":=", "\n", "\t", 
  RowBox[{
   RowBox[{"getNbFileSSheet", "[", "nbFile", "]"}], "/.", "\n", "\t\t", 
   RowBox[{"loadSheetToolbars", "[", "]"}]}]}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]getFileToolbar\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True],

Cell["\<\
\[LeftCeiling]
\tToolbars are just treated as another case of a Plugin, but not always \
attached to the menu or put into a ActionMenu
\[RightFloor]\
\>", "Text",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"getFileToolbar", "[", 
   RowBox[{"nb_", ",", " ", "file_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"fExt", " ", "=", " ", 
       RowBox[{"FileExtension", "[", "file", "]"}]}], ",", "\n", "\t\t\t", 
      "tbName"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"tbName", "=", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"getFExtToolbar", "[", "fExt", "]"}], ",", "\n", "\t", 
        "\t\t\t", 
        RowBox[{"None", "\[RuleDelayed]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"fExt", "===", "\"\<nb\>\""}], ",", " ", 
           RowBox[{"getStylesheetToolbar", "[", "file", "]"}], ",", " ", 
           "None"}], "]"}]}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
     "tbName"}]}], "\n", "\t\t", "]"}]}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]setNbFileToolbar\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"setNbFileToolbar", "[", 
   RowBox[{"nb_", ",", " ", "file_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"currentTb", " ", "=", " ", 
       RowBox[{"IDEData", "[", 
        RowBox[{"nb", ",", " ", "\"\<FileToolbar\>\"", ",", " ", "None"}], 
        "]"}]}], ",", "\n", "\t\t\t", "name"}], "\n", "\t\t\t", "}"}], ",", 
    "\n", "\t\t", 
    RowBox[{
     RowBox[{"name", " ", "=", " ", 
      RowBox[{"getFileToolbar", "[", 
       RowBox[{"nb", ",", " ", "file"}], "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"currentTb", " ", "=!=", " ", "name"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"IDEData", "[", 
          RowBox[{"nb", ",", " ", "\"\<FileToolbar\>\""}], "]"}], " ", "=", 
         "  ", "name"}], ";", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"currentTb", " ", "=!=", " ", "None"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"RemoveNotebookToolbar", "[", 
           RowBox[{"nb", ",", " ", "currentTb"}], "]"}]}], "\n", "\t\t\t\t", 
         "]"}], ";", "\n", "\t\t\t", 
        RowBox[{"UpdateNotebookToolbars", "[", "nb", "]"}]}]}], "\n", 
      "\t\t\t", "]"}], ";"}]}], "\n", "\t\t", "]"}]}]], "CodeInput"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]setAutoSave\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setAutoSave", "[", "nb_", "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"aug", " ", "=", " ", 
       RowBox[{"CurrentValue", "[", 
        RowBox[{"nb", ",", " ", "AutoGeneratedPackage"}], "]"}]}], "}"}], ",",
      "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"aug", " ", "===", " ", "Automatic"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"IDEData", "[", 
         RowBox[{"nb", ",", " ", "\"\<AutoGeneratePackage\>\""}], "]"}], " ", 
        "=", " ", "True"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"CurrentValue", "[", 
          RowBox[{"nb", ",", " ", "AutoGeneratedPackage"}], "]"}], " ", "=", 
         " ", "Inherited"}], ";", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"IDEData", "[", 
          RowBox[{"nb", ",", " ", "\"\<AutoGeneratePackage\>\""}], "]"}], " ",
          "=", " ", "False"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]setNbActions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"setNbActions", "[", "nb_", "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nbActs", ",", " ", "saveAction"}], "}"}], ",", "\n", "\t  ", 
    RowBox[{"(*", " ", 
     RowBox[{"reset", " ", "the", " ", "actions", " ", "to", " ", "start"}], 
     " ", "*)"}], "\n", "\t  ", 
    RowBox[{
     RowBox[{
      RowBox[{"CurrentValue", "[", 
       RowBox[{"nb", ",", " ", "NotebookEventActions"}], "]"}], " ", "=", " ",
       "Inherited"}], ";", "\n", "\t  ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "pull", " ", "the", " ", "events", " ", "from", " ", "the", " ", 
       "stylesheet"}], " ", "*)"}], "\n", "\t  ", 
     RowBox[{"nbActs", " ", "=", " ", 
      RowBox[{"CurrentValue", "[", 
       RowBox[{"nb", ",", " ", "NotebookEventActions"}], "]"}]}], ";", "\n", 
     "\t  ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"nbActs", ",", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<MenuCommand\>\"", ",", " ", "\"\<Save\>\""}], "}"}]}], 
        "]"}], ",", "\n", "\t    ", 
       RowBox[{"saveAction", " ", "=", " ", "\n", "\t      ", 
        RowBox[{"Extract", "[", 
         RowBox[{
          RowBox[{"Association", "[", "nbActs", "]"}], ",", "\n", 
          "\t        ", 
          RowBox[{"Key", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<MenuCommand\>\"", ",", " ", "\"\<Save\>\""}], "}"}], 
           "]"}], ",", "\n", "\t        ", "Hold"}], "\n", "\t        ", 
         "]"}]}], ",", "\n", "\t    ", 
       RowBox[{"saveAction", " ", "=", " ", "None"}]}], "\n", "\t    ", "]"}],
      ";", "\n", "\t  ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"saveAction", ",", " ", "\n", "  ", "\t    ", 
         RowBox[{
          RowBox[{"Hold", "[", 
           RowBox[{"IDESave", "[", 
            RowBox[{"EvaluationNotebook", "[", "]"}], "]"}], "]"}], "|", "\n",
           "  \t      ", 
          RowBox[{"Hold", "[", 
           RowBox[{"CompoundExpression", "[", 
            RowBox[{"_Needs", ",", " ", 
             RowBox[{"IDESave", "[", 
              RowBox[{"EvaluationNotebook", "[", "]"}], "]"}]}], "]"}], 
           "]"}]}]}], "\n", "  \t    ", "]"}], ",", "\n", "\t    ", 
       RowBox[{"saveAction", " ", "=", " ", "None"}]}], "\n", "\t    ", "]"}],
      ";", "\n", "\t  ", 
     RowBox[{
      RowBox[{"IDEData", "[", 
       RowBox[{"nb", ",", " ", "\"\<SavingAction\>\""}], "]"}], " ", "=", " ",
       "saveAction"}], ";", "\n", "\t  ", 
     RowBox[{
      RowBox[{"CurrentValue", "[", 
       RowBox[{"nb", ",", " ", "NotebookEventActions"}], "]"}], "=", "\n", 
      "\t    ", 
      RowBox[{
       RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", 
       "\t      ", 
       RowBox[{"Join", "[", "\n", "  \t      ", 
        RowBox[{
         RowBox[{"{", "\n", "    \t      ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<MenuCommand\>\"", ",", " ", "\"\<Save\>\""}], "}"}], 
           "\[RuleDelayed]", "\n", "    \t        ", 
           RowBox[{"IDESave", "[", 
            RowBox[{"EvaluationNotebook", "[", "]"}], "]"}]}], "\n", "  ", 
          "         ", "}"}], ",", "\n", "          ", 
         RowBox[{"Replace", "[", 
          RowBox[{"nbActs", ",", "\n", "          \t", 
           RowBox[{
            RowBox[{"Except", "[", "_List", "]"}], "\[RuleDelayed]", 
            RowBox[{"{", "}"}]}]}], "\n", "          \t", "]"}], ",", "\n", 
         "    \t    ", 
         RowBox[{"{", "\n", "            ", 
          RowBox[{
           RowBox[{"PassEventsDown", "\[Rule]", "True"}], ",", "\n", "  ", 
           "          ", 
           RowBox[{"EvaluationOrder", "\[Rule]", "After"}]}], "\n", "  ", 
          "\t        ", "}"}]}], "\n", "  ", "  \t   ", "]"}]}]}]}]}], "\n", 
   "\t  ", "]"}]}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GetNotebookExpression\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetNotebookExpression", "[", "nb_", "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"opts", " ", "=", " ", 
      RowBox[{"IDEData", "[", 
       RowBox[{"nb", ",", " ", "\"\<Options\>\"", ",", " ", 
        RowBox[{"{", "}"}]}], "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"Notebook", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookGet", "[", "nb", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Flatten", "[", 
        RowBox[{"List", "@@", "opts"}], "]"}]}]}], "\n", "\t\t\t", "]"}]}], 
   "\n", "\t\t", "]"}]}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NotebookPutFile\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NotebookPutFile", "[", 
    RowBox[{"nb_NotebookObject", ",", " ", "f_String"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "nbObj", ",", "\n", "\t\t\t", "nbExpr", ",", "\n", "\t\t\t", "aug"}], 
      "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "since", " ", "we", " ", "need", " ", "to", " ", "handle", " ", 
        "autogeneration", " ", "stuff", " ", "too"}], "..."}], " ", "*)"}], 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"CurrentValue", "[", 
        RowBox[{"nb", ",", " ", "AutoGeneratedPackage"}], "]"}], " ", "=", 
       " ", "Inherited"}], ";", "\n", "\t\t", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"FileExtension", "[", "f", "]"}], ",", "\n", "\t\t\t", 
        "\"\<nb\>\"", ",", "\n", "\t\t\t\t", 
        RowBox[{"nbExpr", " ", "=", " ", 
         RowBox[{"Get", "[", "f", "]"}]}], ",", "\n", "\t\t\t", "_", ",", 
        "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"nbObj", " ", "=", " ", 
          RowBox[{"NotebookOpen", "[", 
           RowBox[{"f", ",", " ", 
            RowBox[{"Visible", "->", "False"}]}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{"nbExpr", " ", "=", " ", 
          RowBox[{"NotebookGet", "[", "nbObj", "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{"NotebookClose", "[", "nbObj", "]"}], ";"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"WithNotebookPaused", "[", "\n", "\t\t\t", 
       RowBox[{"nb", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"setNbFileStyle", "[", 
          RowBox[{"nb", ",", " ", "f"}], "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"setNbFileToolbar", "[", 
          RowBox[{"nb", ",", " ", "f"}], "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"NotebookPutContents", "[", 
          RowBox[{"nb", ",", " ", "nbExpr"}], "]"}], ";", "\n", "\t\t  ", 
         RowBox[{"setAutoSave", "[", "nb", "]"}], ";", "\n", "  ", "\t\t", 
         RowBox[{"setNbActions", "[", "nb", "]"}], ";"}]}], "\n", "\t\t\t", 
       "]"}], ";"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NotebookSaveContents\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[{
 RowBox[{"NotebookSaveContents", "//", "Clear"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "NotebookSaveContents", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"\"\<AutoGenerateSave\>\"", "\[Rule]", "True"}], "\n", "\t\t", 
    "}"}]}], ";"}], "\n", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "recurseProtect", "}"}], ",", "\n", "\t", 
   RowBox[{
    RowBox[{"NotebookSaveContents", "[", 
     RowBox[{"nb_NotebookObject", ",", " ", "\n", "\t\t", 
      RowBox[{"file", ":", 
       RowBox[{"_String", "|", "Automatic"}], ":", "Automatic"}], ",", "\n", 
      "\t\t", 
      RowBox[{"preemptive", ":", 
       RowBox[{"True", "|", "False"}], ":", "False"}], ",", "\n", "\t\t", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t\t", "]"}], ":=", 
    "\n", "\t\t", 
    RowBox[{"Block", "[", "\n", "\t\t  ", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t    ", 
       RowBox[{"recurseProtect", " ", "=", " ", 
        RowBox[{
         RowBox[{"!", "preemptive"}], "&&", 
         RowBox[{"TrueQ", "[", "recurseProtect", "]"}]}]}], "\n", "\t\t    ", 
       "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "recurseProtect"}], ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"recurseProtect", "=", "True"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"Module", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"f", " ", "=", " ", "file"}], ",", "\n", "\t", "\t", 
             "\t", "\t\t\t", "dir", ",", "\n", "\t", "\t", "\t", "\t\t\t", 
             "nbExpr", ",", "\n", "\t\t\t\t\t\t", "nbObj", ",", "\n", 
             "\t\t\t\t\t\t", "nbFName", ",", "\n", "\t\t\t\t\t\t", 
             "nbPkgName", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"ags", " ", "=", " ", 
              RowBox[{
              "OptionValue", "[", "\"\<AutoGenerateSave\>\"", "]"}]}]}], "\n",
             "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"f", " ", "===", " ", "Automatic"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"f", " ", "=", " ", 
               RowBox[{"IDEPath", "[", 
                RowBox[{"nb", ",", " ", 
                 RowBox[{"Key", "[", "\"\<ActiveFile\>\"", "]"}]}], "]"}]}]}],
              "\n", "\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"f", "=!=", "None"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"f", " ", "=", " ", 
                RowBox[{"IDEPath", "[", 
                 RowBox[{"nb", ",", " ", "f"}], "]"}]}], ";", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"Switch", "[", 
                RowBox[{
                 RowBox[{"FileExtension", "[", "f", "]"}], ",", "\n", "\t", 
                 "\t", "\t", "\t", "\t\t\t", "\"\<nb\>\"", ",", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"nbExpr", " ", "=", " ", 
                   RowBox[{"GetNotebookExpression", "[", "nb", "]"}]}], ";", 
                  "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{"preemptive", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PreemptiveQueued", "[", 
                    RowBox[{"nb", ",", " ", 
                    RowBox[{"Export", "[", 
                    RowBox[{"f", ",", " ", "nbExpr"}], "]"}]}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Export", "[", 
                    RowBox[{"f", ",", " ", "nbExpr"}], "]"}], ";"}]}], " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{"would", " ", "Put", " ", "be", " ", 
                    RowBox[{"better", " ", "?"}]}], " ", "*)"}], "\n", 
                   "\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"preemptive", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Function", "[", 
                    RowBox[{"Null", ",", " ", 
                    RowBox[{"PreemptiveQueued", "[", 
                    RowBox[{"nb", ",", " ", "#"}], "]"}], ",", " ", 
                    "HoldAllComplete"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"#", "&"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], 
                   "@", "\n", "\t\t\t\t\t\t\t\t  ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ags", " ", "&&", " ", 
                    RowBox[{"IDEData", "[", 
                    RowBox[{"nb", ",", " ", "\"\<AutoGeneratePackage\>\""}], 
                    "]"}]}], ",", "\n", "  ", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"nbFName", " ", "=", " ", 
                    RowBox[{"NotebookFileName", "[", "nb", "]"}]}], ";", "\n",
                     "  ", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"StringQ", "[", "nbFName", "]"}], ",", "\n", "  ",
                     "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"nbPkgName", " ", "=", " ", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"nbFName", ",", " ", 
                    RowBox[{"\"\<.nb\>\"", "\[Rule]", "\"\<.m\>\""}]}], 
                    "]"}]}], ";", "\n", "  ", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"FileExistsQ", "[", "nbPkgName", "]"}], ",", "\n",
                     "  ", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "RenameFile", "[", "\n", "  ", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "nbPkgName", ",", "\n", "  ", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"f", ",", " ", 
                    RowBox[{"\"\<.nb\>\"", "\[Rule]", "\"\<.m\>\""}]}], "]"}],
                     ",", "\n", "  ", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"OverwriteTarget", "\[Rule]", "True"}]}], "\n", 
                    "  ", "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "  ", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "  ", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "  ", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"\"\<m\>\"", "|", "\"\<wl\>\""}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{"preemptive", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"nbExpr", " ", "=", 
                    RowBox[{"GetNotebookExpression", "[", "nb", "]"}]}], ";", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PreemptiveQueued", "[", 
                    RowBox[{"nb", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Internal`WithLocalSettings", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"nbObj", " ", "=", " ", 
                    RowBox[{"CreateDocument", "[", 
                    RowBox[{"nbExpr", ",", " ", 
                    RowBox[{"Visible", "\[Rule]", "False"}]}], "]"}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "FrontEndExecute", "@", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    "FrontEndToken", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    "nbObj", ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "\"\<Save\>\"", ",", "\n", "\t", "\t", "\t", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"f", ",", " ", "\"\<Package\>\""}], "}"}]}], "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"NotebookClose", "[", "nbObj", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"nbObj", " ", "=", " ", "nb"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "FrontEndExecute", "@", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "FrontEndToken", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "nbObj", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "\"\<Save\>\"", ",", "\n", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"f", ",", " ", "\"\<Package\>\""}], "}"}]}], "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
                 "_", ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{"preemptive", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"nbExpr", " ", "=", 
                    RowBox[{"GetNotebookExpression", "[", "nb", "]"}]}], ";", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PreemptiveQueued", "[", 
                    RowBox[{"nb", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Internal`WithLocalSettings", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"nbObj", " ", "=", " ", 
                    RowBox[{"CreateDocument", "[", 
                    RowBox[{"nbExpr", ",", " ", 
                    RowBox[{"Visible", "\[Rule]", "False"}]}], "]"}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "FrontEndExecute", "@", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    "FrontEndToken", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    "nbObj", ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "\"\<Save\>\"", ",", "\n", "\t", "\t", "\t", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"f", ",", " ", "\"\<Text\>\""}], "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"NotebookClose", "[", "nbObj", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"nbObj", " ", "=", " ", "nb"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "FrontEndExecute", "@", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "FrontEndToken", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "nbObj", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "\"\<Save\>\"", ",", "\n", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"f", ",", " ", "\"\<Text\>\""}], "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                "]"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", 
          "\t\t\t\t\t", "]"}], ";"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], "CodeInput"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NotebookPutScratch\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"NotebookPutScratch", "[", 
   RowBox[{"nb_", ",", " ", "expr_Notebook"}], "]"}], ":=", "\n", "  ", 
  RowBox[{"NotebookPutFile", "[", 
   RowBox[{"nb", ",", " ", 
    RowBox[{"CreateProjectScratchFile", "[", 
     RowBox[{"nb", ",", " ", "expr"}], "]"}]}], "]"}]}]], "CodeInput"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]File Operations\[RightFloor]", "CodeSubsection",
 Evaluatable->True],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GetFileTabName\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetFileTabName", "[", 
   RowBox[{"nb_", ",", " ", "f_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"tabs", " ", "=", " ", 
       RowBox[{"IDEData", "[", 
        RowBox[{"nb", ",", " ", "\"\<Tabs\>\""}], "]"}]}], ",", "\n", 
      "\t\t\t", "tns", ",", "\n", "\t\t\t", "tabName"}], "\n", "\t\t\t", 
     "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"tabName", " ", "=", "\n", "\t\t\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Lookup", "[", 
            RowBox[{
             RowBox[{"t", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", " ", "\"\<File\>\""}], 
            "]"}], "\[Equal]", "f"}], ",", " ", 
          RowBox[{"Return", "[", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", "Do"}], "]"}]}], "]"}],
         ",", " ", 
        RowBox[{"{", 
         RowBox[{"t", ",", " ", "tabs"}], "}"}]}], "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"tabName", "===", "Null"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"tabName", " ", "=", " ", 
         RowBox[{"FileBaseName", "[", "f", "]"}]}], ";", "\n", "\t\t\t", 
        RowBox[{"tns", " ", "=", " ", 
         RowBox[{"tabs", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], ";", "\n", 
        "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"tns", ",", " ", "tabName"}], "]"}], ",", "\n", "\t", 
          "\t\t\t", 
          RowBox[{"tabName", " ", "=", " ", 
           RowBox[{"tabName", " ", "<>", " ", "\"\<.\>\"", " ", "<>", " ", 
            RowBox[{"FileExtension", "[", "f", "]"}]}]}]}], "\n", "\t\t\t\t", 
         "]"}], ";", "\n", "\t\t\t", 
        RowBox[{"tabName", "=", "\n", "\t\t\t\t", 
         RowBox[{"NestWhile", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"#", " ", "<>", " ", "\"\</\>\"", " ", "<>", " ", 
             RowBox[{"FileNameTake", "[", 
              RowBox[{"f", ",", " ", 
               RowBox[{"-", 
                RowBox[{"Length", "[", 
                 RowBox[{"URLParse", "[", 
                  RowBox[{"#", ",", " ", "\"\<Path\>\""}], "]"}], "]"}]}]}], 
              "]"}]}], "&"}], ",", "\n", "\t", "\t\t\t\t", "tabName", ",", 
           "\n", "\t", "\t\t\t\t", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"tns", ",", " ", "#"}], "]"}], "&"}], ",", "\n", 
           "\t\t\t\t\t", "1", ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"FileNameDepth", "[", "f", "]"}], "-", "1"}]}], "\n", 
          "\t", "\t\t\t\t", "]"}]}]}]}], "\n", "\t\t\t", "]"}], ";", "\n", 
     "\t\t", "tabName"}]}], "\n", "\t\t", "]"}]}]], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]IDEOpen\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IDEOpen", "[", 
    RowBox[{"nb_NotebookObject", ",", " ", 
     RowBox[{"f_String", "?", "FileExistsQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "nbObj", ",", "\n", "\t\t\t", "nbExpr", ",", "\n", "\t\t\t", 
       "tabName"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"tabName", " ", "=", " ", 
       RowBox[{"GetFileTabName", "[", 
        RowBox[{"nb", ",", " ", "f"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"IDETabExists", "[", 
           RowBox[{"nb", ",", " ", "tabName"}], "]"}]}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"NotebookCreateTab", "[", 
         RowBox[{"nb", ",", " ", "tabName", ",", " ", "\n", "\t", "\t\t\t", 
          RowBox[{"{", "\n", "\t", "\t\t\t\t", 
           RowBox[{"\"\<File\>\"", "\[Rule]", "f"}], "\t", "\n", "\t\t\t\t\t",
            "}"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"NotebookSwitchTab", "[", 
       RowBox[{"nb", ",", " ", "tabName"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IDEOpen", "[", 
    RowBox[{"nb_IDENotebookObject", ",", " ", 
     RowBox[{"f_String", "?", "FileExistsQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"IDEOpen", "[", 
    RowBox[{
     RowBox[{"nb", "[", "\"\<Notebook\>\"", "]"}], ",", " ", "f"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IDEOpen", "[", 
    RowBox[{"nb_NotebookObject", ",", " ", "expr_Notebook"}], "]"}], ":=", 
   "\n", "  ", 
   RowBox[{"IDEOpen", "[", 
    RowBox[{"nb", ",", " ", 
     RowBox[{"CreateProjectScratchFile", "[", 
      RowBox[{"nb", ",", " ", "expr"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IDEOpen", "[", 
    RowBox[{"nb_IDENotebookObject", ",", " ", "expr_Notebook"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"IDEOpen", "[", 
    RowBox[{
     RowBox[{"nb", "[", "\"\<Notebook\>\"", "]"}], ",", " ", "expr"}], 
    "]"}]}], ";"}]}], "CodeInput"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]IDESave\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[{
 RowBox[{"IDESave", "//", "Clear"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IDESave", "[", 
    RowBox[{"nb_NotebookObject", ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"TrueQ", "@", 
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"NotebookInformation", "[", "nb", "]"}], ",", " ", 
        "\"\<ModifiedInMemory\>\"", ",", " ", "True"}], "]"}]}], ",", " ", 
     "\n", "\t  ", 
     RowBox[{"NotebookSaveContents", "[", 
      RowBox[{"nb", ",", " ", "ops"}], "]"}]}], "\n", "\t  ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"IDESave", "[", 
   RowBox[{"nb_IDENotebookObject", ",", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"IDESave", "[", 
   RowBox[{
    RowBox[{"nb", "[", "\"\<Notebook\>\"", "]"}], ",", " ", "ops"}], 
   "]"}]}]}], "CodeInput"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]IDEClose\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IDEClose", "[", 
    RowBox[{"nb_NotebookObject", ",", " ", "tabName_"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"IDETabExists", "[", "tabName", "]"}], ",", "\n", "\t\t", 
     RowBox[{"NotebookCloseTab", "[", 
      RowBox[{"nb", ",", " ", "tabName"}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"IDEClose", "[", 
   RowBox[{"nb_IDENotebookObject", ",", " ", "tabName_"}], "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"IDEClose", "[", 
   RowBox[{
    RowBox[{"nb", "[", "\"\<Notebook\>\"", "]"}], ",", " ", "tabName"}], 
   "]"}]}]}], "CodeInput"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "InputSection"]
}, Open  ]],

Cell["", "SectionSeparator"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ide", " ", "=", " ", 
   RowBox[{"IDENotebookObject", "[", 
    RowBox[{"EvaluationNotebook", "[", "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[121]:="],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"IDESave", "[", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", " ", 
    RowBox[{"\"\<AutoGenerateSave\>\"", "\[Rule]", "False"}]}], "]"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellLabel->"In[137]:="],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.485803`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[137]="]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ide", "@", 
   RowBox[{"\"\<Save\>\"", "[", "]"}]}], "//", "AbsoluteTiming"}]], "Input",
 CellLabel->"In[149]:="],

Cell[BoxData[
 RowBox[{"NotebookSaveContents", "[", "Evaluation"}]], "Input"],

Cell[BoxData[
 RowBox[{"<<", "EasyIDE`Notebooks`Manipulation`"}]], "Input",
 CellLabel->"In[129]:="],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetNotebookExpression", "[", 
    RowBox[{"EvaluationNotebook", "[", "]"}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellLabel->"In[130]:="],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.055982`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[130]="]
}, Open  ]],

Cell[BoxData["EasyIDENotebooksManipulation"], "Input"]
},
WindowSize->{808, 755},
WindowMargins->{{244, Automatic}, {Automatic, 24}},
TaggingRules->{
 "UUIDButtons" -> {
   "Active" -> {
     "Button-89ffd2c3-ec41-4179-a9b1-8e28670bca2c" -> False, 
      "Button-ca46e5e0-4fd1-47e8-8cf6-72998922b757" -> False, 
      "Button-a6d68254-3684-4d32-83fc-e5ef6f443930" -> False}}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 44, 0, 70, "CodeSection",ExpressionUUID->"48583ddd-738b-4e9d-8b9e-864d532699ca"],
Cell[469, 17, 140, 4, 70, "Text",ExpressionUUID->"52dc60d3-e73f-4f41-9c23-abdf00cc669d",
 Evaluatable->True],
Cell[612, 23, 621, 17, 70, "CodeInput",ExpressionUUID->"74f83e35-fa4c-4d2c-9fc9-de377df89af7"],
Cell[1236, 42, 297, 8, 70, "CodeInput",ExpressionUUID->"ddf4a846-c1dc-47eb-8fad-5343a4bfdeea"],
Cell[1536, 52, 122, 2, 70, "Text",ExpressionUUID->"c5805ff4-9872-4e87-9a9e-423a09e9406b",
 Evaluatable->True],
Cell[1661, 56, 400, 12, 70, "CodeInput",ExpressionUUID->"3dc7825f-390d-428e-8180-1047a3742d48"],
Cell[2064, 70, 99, 2, 70, "InputSection",ExpressionUUID->"6c06d878-dea7-4d75-bc2d-53d018cec041"],
Cell[CellGroupData[{
Cell[2188, 76, 94, 1, 70, "CodeSubsection",ExpressionUUID->"ef1f2396-01ba-4bef-8765-6a0663b225c2",
 Evaluatable->True],
Cell[CellGroupData[{
Cell[2307, 81, 95, 1, 70, "CodeSubsubsection",ExpressionUUID->"c6ff4d27-ddf5-47dc-bf9c-0f693fa654a1",
 Evaluatable->True],
Cell[2405, 84, 105, 5, 70, "Text",ExpressionUUID->"03e0435e-b1e7-496b-ad24-31dba1037f9e",
 Evaluatable->True],
Cell[2513, 91, 1100, 26, 70, "CodeInput",ExpressionUUID->"f0311094-b714-48f4-a80e-2ae55e06af26"],
Cell[3616, 119, 1634, 38, 70, "CodeInput",ExpressionUUID->"688c6b79-bebc-400e-b491-b8e40e9dfa9a"],
Cell[5253, 159, 1240, 32, 70, "CodeInput",ExpressionUUID->"350e5aea-81de-43c8-88fc-bb8861df9be0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6530, 196, 90, 1, 70, "CodeSubsubsection",ExpressionUUID->"9928a01b-b6a8-4e57-acc9-9f31672bcbd9",
 Evaluatable->True],
Cell[CellGroupData[{
Cell[6645, 201, 96, 1, 70, "CodeSubsubsubsection",ExpressionUUID->"732c24f3-10c6-41b7-9694-120c73f1d1b3",
 Evaluatable->True],
Cell[6744, 204, 799, 17, 70, "CodeInput",ExpressionUUID->"8beacf28-b903-4882-8b98-c249c490262b"],
Cell[7546, 223, 177, 4, 70, "CodeInput",ExpressionUUID->"f42f8181-0e82-460b-b461-38bc798a6621"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7760, 232, 94, 1, 70, "CodeSubsubsubsection",ExpressionUUID->"c7efc5e3-7ab9-4d13-9ef0-7b1553880452",
 Evaluatable->True],
Cell[7857, 235, 982, 22, 70, "CodeInput",ExpressionUUID->"2a47d5e8-935e-4d48-b17a-37d4e60f8002"],
Cell[8842, 259, 3310, 79, 70, "CodeInput",ExpressionUUID->"932f1bb6-bda4-4fbb-8777-eaf9836eebf0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12189, 343, 96, 1, 70, "CodeSubsubsubsection",ExpressionUUID->"b7d16b1c-08d2-4b05-9210-465a2cd79c3d",
 Evaluatable->True],
Cell[12288, 346, 938, 22, 70, "CodeInput",ExpressionUUID->"652ddb95-26b5-4b71-92e2-82e52da3dfb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13263, 373, 93, 1, 70, "CodeSubsubsubsection",ExpressionUUID->"32e0f87a-6806-4d3e-bfd6-f2d31fa3a73e",
 Evaluatable->True],
Cell[13359, 376, 1107, 26, 70, "CodeInput",ExpressionUUID->"def37215-ae7c-47a7-8592-3e38fd592237"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[14515, 408, 92, 1, 70, "CodeSubsubsection",ExpressionUUID->"d041a97a-15f0-4687-b15b-b5eeb8280f88",
 Evaluatable->True],
Cell[CellGroupData[{
Cell[14632, 413, 93, 1, 70, "CodeSubsubsubsection",ExpressionUUID->"bfec20a3-de4a-48e1-97c6-69ce1ae9ca61",
 Evaluatable->True],
Cell[14728, 416, 795, 17, 70, "CodeInput",ExpressionUUID->"cecef486-820b-4ff3-ba53-507b27d199df"],
Cell[15526, 435, 176, 4, 70, "CodeInput",ExpressionUUID->"2d4c2d1d-c7a2-4024-905b-493e5d69d627"]
}, Closed]],
Cell[CellGroupData[{
Cell[15739, 444, 99, 1, 70, "CodeSubsubsubsection",ExpressionUUID->"1cac6661-a5c0-47dd-aa3d-eebeb3c922a3",
 Evaluatable->True],
Cell[15841, 447, 833, 18, 70, "CodeInput",ExpressionUUID->"d9299b68-a908-493e-a08d-95e63dd7f874"],
Cell[16677, 467, 245, 5, 70, "CodeInput",ExpressionUUID->"f559c8ac-7160-41c9-97d4-c383ef8018ef"]
}, Closed]],
Cell[CellGroupData[{
Cell[16959, 477, 93, 1, 70, "CodeSubsubsubsection",ExpressionUUID->"6285d09f-d2f7-439a-9dc7-b88a66939727",
 Evaluatable->True],
Cell[17055, 480, 192, 6, 70, "Text",ExpressionUUID->"d8a8e2da-ff3a-487c-99cd-d29e9d575a6f",
 Evaluatable->True],
Cell[17250, 488, 954, 23, 70, "CodeInput",ExpressionUUID->"b98d76ed-795d-4955-9be6-2781ba084705"]
}, Closed]],
Cell[CellGroupData[{
Cell[18241, 516, 95, 1, 70, "CodeSubsubsubsection",ExpressionUUID->"a117e01c-6dbc-405e-af8d-84c414eeae64",
 Evaluatable->True],
Cell[18339, 519, 1381, 33, 70, "CodeInput",ExpressionUUID->"86dfa9b7-42de-47a3-b520-a7928c9cd7a0"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[19769, 558, 87, 1, 70, "CodeSubsubsection",ExpressionUUID->"dcfc0d50-85d5-4c1d-ba26-c70aeee60694",
 Evaluatable->True],
Cell[19859, 561, 1065, 27, 70, "CodeInput",ExpressionUUID->"6a70c127-1ff8-4dd0-ad5a-a77290d8afc5"]
}, Closed]],
Cell[CellGroupData[{
Cell[20961, 593, 88, 1, 70, "CodeSubsubsection",ExpressionUUID->"4860fedf-e966-405b-864d-81cf11dc1d67",
 Evaluatable->True],
Cell[21052, 596, 3911, 92, 70, "CodeInput",ExpressionUUID->"8b9973f5-95c5-4682-bf9c-ccef8c6d5f34"]
}, Closed]],
Cell[CellGroupData[{
Cell[25000, 693, 97, 1, 70, "CodeSubsubsection",ExpressionUUID->"301c3585-ff46-4486-8680-a21ace8bf592",
 Evaluatable->True],
Cell[25100, 696, 770, 19, 70, "CodeInput",ExpressionUUID->"671a255c-bc26-43b1-8b20-d9f7597264fc"]
}, Closed]],
Cell[CellGroupData[{
Cell[25907, 720, 91, 1, 70, "CodeSubsubsection",ExpressionUUID->"3f946aba-1748-4aab-8859-081809dceb64",
 Evaluatable->True],
Cell[26001, 723, 2257, 51, 70, "CodeInput",ExpressionUUID->"737222d5-d84e-42cb-99d8-1b0b5dddbf51"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28295, 779, 96, 1, 70, "CodeSubsubsection",ExpressionUUID->"a4168772-12c8-4d1f-b72e-6a1a08dc7b2e",
 Evaluatable->True],
Cell[28394, 782, 12529, 244, 70, "CodeInput",ExpressionUUID->"8f81de9e-9cb0-4789-a044-3a1d6dbb3f64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40960, 1031, 94, 1, 70, "CodeSubsubsection",ExpressionUUID->"66a8beea-0b36-4030-a6ad-be913283c2bb",
 Evaluatable->True],
Cell[41057, 1034, 314, 7, 70, "CodeInput",ExpressionUUID->"6927626e-eaae-4d8c-9577-6b973fa3091c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41420, 1047, 88, 1, 70, "CodeSubsection",ExpressionUUID->"05740431-4469-46e4-a179-5841d0bfa719",
 Evaluatable->True],
Cell[CellGroupData[{
Cell[41533, 1052, 90, 1, 70, "CodeSubsubsection",ExpressionUUID->"f71cd84b-5ce3-42d9-a9db-e7a5d627ce64",
 Evaluatable->True],
Cell[41626, 1055, 2991, 72, 70, "CodeInput",ExpressionUUID->"46d51192-e98e-44b9-ac01-6f3303e124dd"]
}, Closed]],
Cell[CellGroupData[{
Cell[44654, 1132, 83, 1, 70, "CodeSubsubsection",ExpressionUUID->"37753d56-6053-48a7-91e7-f9ac5c795f4e",
 Evaluatable->True],
Cell[44740, 1135, 2201, 58, 70, "CodeInput",ExpressionUUID->"f41f9ae3-56b7-430e-856c-e71781a7bfab"]
}, Closed]],
Cell[CellGroupData[{
Cell[46978, 1198, 83, 1, 70, "CodeSubsubsection",ExpressionUUID->"e65b1e6f-8f1d-48c7-adf9-1a9a6ddb1aa2",
 Evaluatable->True],
Cell[47064, 1201, 973, 27, 70, "CodeInput",ExpressionUUID->"79c9d8eb-cc7b-4eaf-a43f-2dda08a19004"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48074, 1233, 84, 1, 70, "CodeSubsubsection",ExpressionUUID->"f6879ec6-f6db-4953-9abf-0d56da67eddb",
 Evaluatable->True],
Cell[48161, 1236, 657, 19, 70, "CodeInput",ExpressionUUID->"7e64a2e4-7bb7-4154-ac1c-0643b73519d2"]
}, Open  ]]
}, Open  ]],
Cell[48845, 1259, 76, 2, 70, "InputSection",ExpressionUUID->"ba5cde76-7b65-4b37-895b-d0e82d777f8f"]
}, Open  ]],
Cell[48936, 1264, 28, 0, 70, "SectionSeparator",ExpressionUUID->"deda6457-79e2-4f1f-a3e4-89a64d50d9ee"],
Cell[48967, 1266, 191, 5, 70, "Input",ExpressionUUID->"cd660e11-118d-4a82-85bd-217ab73ac351"],
Cell[CellGroupData[{
Cell[49183, 1275, 254, 7, 70, "Input",ExpressionUUID->"4d1a2b55-3621-4625-b908-0561cec3d8f5"],
Cell[49440, 1284, 109, 3, 70, "Output",ExpressionUUID->"01a889f4-3c3a-475a-bdd5-20c0c642aaf5"]
}, Open  ]],
Cell[49564, 1290, 148, 4, 70, "Input",ExpressionUUID->"653c990e-ad08-49d5-bba4-9c665c942420"],
Cell[49715, 1296, 77, 1, 70, "Input",ExpressionUUID->"0f6237a0-43a1-4fb3-90e6-8e98b6fb04b2"],
Cell[49795, 1299, 100, 2, 70, "Input",ExpressionUUID->"02d5bb40-16a0-4a04-9573-d516d2e2ef0a"],
Cell[CellGroupData[{
Cell[49920, 1305, 200, 6, 70, "Input",ExpressionUUID->"c5ea996f-8d6a-4403-9b2b-271e6f694c4c"],
Cell[50123, 1313, 109, 3, 70, "Output",ExpressionUUID->"e97c38e0-f9ee-494b-aace-683b2a9177e8"]
}, Open  ]],
Cell[50247, 1319, 54, 0, 70, "Input",ExpressionUUID->"ed1c1ae6-e756-41a6-9eb0-227eb4b395a1"]
}
]
*)

